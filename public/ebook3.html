<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>📚 StudyHub - Socio-Psico-Pedagogico</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #6366f1;
            --primary-light: #818cf8;
            --primary-dark: #4f46e5;
            --secondary-color: #06b6d4;
            --accent-color: #f59e0b;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;

            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-card: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --text-muted: #94a3b8;
            --border-color: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);

            --border-radius-sm: 0.375rem;
            --border-radius-md: 0.5rem;
            --border-radius-lg: 0.75rem;
            --border-radius-xl: 1rem;
            --border-radius-2xl: 1.5rem;

            --header-height: 70px;
            --nav-height: 60px;
            --total-header-height: 130px;

            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .dark-theme {
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --bg-card: #334155;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --border-color: #475569;
        }

        body {
            font-family: var(--font-family);
            background: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.3s ease;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Header migliorato */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--border-color);
            transition: all 0.3s ease;
            height: var(--total-header-height);
        }

        .dark-theme .header {
            background: rgba(15, 23, 42, 0.95);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .header-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: var(--header-height);
            gap: 1rem;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: var(--border-radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-btn {
            width: 44px;
            height: 44px;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border-radius: var(--border-radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.1rem;
            min-width: 44px;
            min-height: 44px;
        }

        .action-btn:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-1px);
        }

        .action-btn.active {
            background: var(--primary-color);
            color: white;
        }

        /* Navigation migliorata */
        .nav-container {
            height: var(--nav-height);
            display: flex;
            align-items: center;
            border-top: 1px solid var(--border-color);
            overflow: hidden;
        }

        .nav-subjects {
            display: flex;
            gap: 0.5rem;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
            padding: 0.5rem 0;
            width: 100%;
        }

        .nav-subjects::-webkit-scrollbar {
            display: none;
        }

        .subject-btn {
            flex-shrink: 0;
            padding: 0.75rem 1.25rem;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border-radius: var(--border-radius-xl);
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
            min-height: 40px;
            font-size: 0.9rem;
        }

        .subject-btn:hover {
            background: var(--primary-light);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .subject-btn.active {
            background: var(--primary-color);
            color: white;
            box-shadow: var(--shadow-lg);
        }

        /* Main content */
        .main-container {
            margin-top: var(--total-header-height);
            min-height: calc(100vh - var(--total-header-height));
        }

        .content-wrapper {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem 1rem;
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 2rem;
        }

        /* Sidebar TOC */
        .sidebar {
            position: sticky;
            top: calc(var(--total-header-height) + 2rem);
            height: fit-content;
            max-height: calc(100vh - var(--total-header-height) - 4rem);
            overflow-y: auto;
            background: var(--bg-card);
            border-radius: var(--border-radius-2xl);
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
        }

        .sidebar-header {
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .toc-item {
            display: block;
            padding: 0.75rem;
            margin-bottom: 0.25rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: var(--border-radius-lg);
            transition: all 0.2s ease;
            font-size: 0.9rem;
            border-left: 3px solid transparent;
            cursor: pointer;
            position: relative;
        }

        .toc-item:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-left-color: var(--primary-color);
            transform: translateX(4px);
        }

        .toc-item.active {
            background: var(--primary-color);
            color: white;
            border-left-color: var(--primary-dark);
        }

        .toc-item.completed {
            color: var(--success-color);
        }

        .toc-item.completed::before {
            content: "✓ ";
            font-weight: bold;
        }

        .toc-item.current-reading {
            background: var(--accent-color);
            color: white;
            animation: pulse 2s infinite;
        }

        /* Content area */
        .content-area {
            background: var(--bg-card);
            border-radius: var(--border-radius-2xl);
            padding: 2rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-color);
            min-height: 600px;
        }

        .section {
            display: none;
            animation: fadeIn 0.4s ease-out;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .lesson-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border-color);
        }

        .lesson-title {
            font-size: 2.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 0.5rem;
        }

        .lesson-subtitle {
            font-size: 1.1rem;
            color: var(--text-secondary);
            font-weight: 400;
        }

        /* Cards modernizzate */
        .card {
            background: var(--bg-card);
            border-radius: var(--border-radius-xl);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .card-highlight {
            background: linear-gradient(135deg, #fef3c7, #fde68a);
            border-left: 4px solid var(--warning-color);
        }

        .dark-theme .card-highlight {
            background: linear-gradient(135deg, #451a03, #78350f);
        }

        .card-important {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border-left: 4px solid var(--error-color);
        }

        .dark-theme .card-important {
            background: linear-gradient(135deg, #450a0a, #7f1d1d);
        }

        .card-tip {
            background: linear-gradient(135deg, #dbeafe, #bfdbfe);
            border-left: 4px solid var(--secondary-color);
        }

        .dark-theme .card-tip {
            background: linear-gradient(135deg, #0c4a6e, #075985);
        }

        .card-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        /* Enhanced Audio Player */
        .floating-controls {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 999;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .audio-player {
            background: var(--bg-card);
            backdrop-filter: blur(20px);
            border-radius: var(--border-radius-2xl);
            padding: 1.5rem;
            box-shadow: var(--shadow-xl);
            border: 1px solid var(--border-color);
            min-width: 320px;
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .audio-player.visible {
            transform: translateY(0);
            opacity: 1;
        }

        .audio-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .audio-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .close-audio {
            background: none;
            border: none;
            color: var(--text-muted);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 4px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }

        .close-audio:hover {
            background: var(--error-color);
            color: white;
        }

        .audio-controls {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .main-audio-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1rem;
        }

        .nav-btn:hover {
            background: var(--primary-light);
            color: white;
            transform: scale(1.05);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .play-btn {
            width: 50px;
            height: 50px;
            border: none;
            background: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 1.2rem;
            margin: 0 0.5rem;
        }

        .play-btn:hover {
            background: var(--primary-dark);
            transform: scale(1.05);
        }

        .play-btn.reading {
            animation: pulse 2s infinite;
        }

        .secondary-controls {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .control-btn {
            width: 40px;
            height: 40px;
            border: none;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border-radius: var(--border-radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .control-btn:hover {
            background: var(--primary-light);
            color: white;
        }

        .speed-indicator {
            font-size: 0.8rem;
            color: var(--text-muted);
            margin-top: 0.5rem;
            text-align: center;
        }

        .audio-progress {
            margin-bottom: 1rem;
        }

        .current-reading-info {
            background: var(--bg-secondary);
            padding: 0.75rem;
            border-radius: var(--border-radius-lg);
            font-size: 0.8rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
            border-left: 3px solid var(--primary-color);
        }

        /* Quick Actions FAB */
        .fab-container {
            position: relative;
        }

        .fab-main {
            width: 60px;
            height: 60px;
            border: none;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-xl);
            transition: all 0.3s ease;
            font-size: 1.5rem;
        }

        .fab-main:hover {
            transform: scale(1.1) rotate(90deg);
        }

        .fab-menu {
            position: absolute;
            bottom: 80px;
            right: 0;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            opacity: 0;
            visibility: hidden;
            transform: scale(0.8);
            transition: all 0.3s ease;
        }

        .fab-menu.open {
            opacity: 1;
            visibility: visible;
            transform: scale(1);
        }

        .fab-item {
            width: 50px;
            height: 50px;
            border: none;
            background: var(--bg-card);
            color: var(--text-primary);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: var(--shadow-lg);
            transition: all 0.2s ease;
            border: 1px solid var(--border-color);
        }

        .fab-item:hover {
            background: var(--primary-color);
            color: white;
            transform: scale(1.1);
        }

        /* Progress indicator */
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            transition: width 0.3s ease;
            z-index: 1001;
        }

        /* Status notifications migliorati */
        .status-notification {
            position: fixed;
            top: calc(var(--total-header-height) + 1rem);
            right: 2rem;
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius-xl);
            padding: 1rem 1.5rem;
            box-shadow: var(--shadow-lg);
            transform: translateX(100%);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 1002;
            max-width: 300px;
            min-width: 250px;
        }

        .status-notification.show {
            transform: translateX(0);
            opacity: 1;
        }

        .status-notification.success {
            border-left: 4px solid var(--success-color);
            background: linear-gradient(135deg, #dcfce7, #bbf7d0);
        }

        .dark-theme .status-notification.success {
            background: linear-gradient(135deg, #14532d, #166534);
        }

        .status-notification.warning {
            border-left: 4px solid var(--warning-color);
            background: linear-gradient(135deg, #fef3c7, #fde68a);
        }

        .dark-theme .status-notification.warning {
            background: linear-gradient(135deg, #451a03, #78350f);
        }

        .status-notification.error {
            border-left: 4px solid var(--error-color);
            background: linear-gradient(135deg, #fee2e2, #fecaca);
        }

        .dark-theme .status-notification.error {
            background: linear-gradient(135deg, #450a0a, #7f1d1d);
        }

        /* Index grid modernizzato */
        .index-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .subject-card {
            background: var(--bg-card);
            border-radius: var(--border-radius-2xl);
            padding: 2rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-md);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .subject-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .subject-card:hover {
            transform: translateY(-8px);
            box-shadow: var(--shadow-xl);
        }

        .subject-card-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .subject-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: var(--border-radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .subject-card-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-primary);
        }

        .lesson-link {
            display: block;
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: var(--border-radius-lg);
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
            cursor: pointer;
        }

        .lesson-link:hover {
            background: var(--bg-secondary);
            color: var(--text-primary);
            border-left-color: var(--primary-color);
            transform: translateX(8px);
        }

        /* Responsive design migliorato */
        @media (max-width: 1024px) {
            .content-wrapper {
                grid-template-columns: 1fr;
                padding: 1rem;
                gap: 1rem;
            }

            .sidebar {
                position: relative;
                top: auto;
                max-height: 400px;
                margin-bottom: 1rem;
                order: -1;
            }

            .floating-controls {
                bottom: 1rem;
                right: 1rem;
            }

            .audio-player {
                min-width: 280px;
            }
        }

        @media (max-width: 768px) {
            :root {
                --header-height: 60px;
                --nav-height: 50px;
                --total-header-height: 110px;
            }

            .header-top {
                height: var(--header-height);
                padding: 0 0.5rem;
            }

            .nav-container {
                height: var(--nav-height);
                padding: 0 0.5rem;
            }

            .main-container {
                margin-top: var(--total-header-height);
            }

            .logo {
                font-size: 1.25rem;
            }

            .logo-icon {
                width: 36px;
                height: 36px;
            }

            .lesson-title {
                font-size: 1.8rem;
            }

            .content-area {
                padding: 1.5rem;
                border-radius: var(--border-radius-xl);
            }

            .content-wrapper {
                padding: 1rem 0.75rem;
            }

            .floating-controls {
                bottom: 1rem;
                right: 1rem;
                left: 1rem;
                flex-direction: column-reverse;
            }

            .audio-player {
                min-width: auto;
                width: 100%;
                padding: 1rem;
                border-radius: var(--border-radius-xl);
            }

            .audio-controls {
                flex-wrap: wrap;
                gap: 0.75rem;
            }

            .main-audio-controls {
                flex: 1;
                justify-content: center;
            }

            .secondary-controls {
                width: 100%;
                justify-content: center;
            }

            .index-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
                margin-top: 1rem;
            }

            .subject-card {
                padding: 1.5rem;
            }

            .fab-main {
                width: 56px;
                height: 56px;
                font-size: 1.3rem;
            }

            .fab-item {
                width: 46px;
                height: 46px;
            }

            .status-notification {
                right: 1rem;
                left: 1rem;
                max-width: none;
                text-align: center;
            }

            .sidebar {
                max-height: 300px;
                padding: 1rem;
            }

            .nav-subjects {
                gap: 0.25rem;
            }

            .subject-btn {
                padding: 0.6rem 1rem;
                font-size: 0.85rem;
                min-height: 36px;
            }

            .action-btn {
                width: 40px;
                height: 40px;
                min-width: 40px;
                min-height: 40px;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .header-content {
                padding: 0 0.5rem;
            }

            .content-wrapper {
                padding: 0.5rem;
            }

            .floating-controls {
                bottom: 0.5rem;
                right: 0.5rem;
                left: 0.5rem;
            }

            .audio-player {
                padding: 0.75rem;
            }

            .lesson-title {
                font-size: 1.5rem;
            }

            .content-area {
                padding: 1rem;
            }

            .status-notification {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }
        }

        /* Animations */
        @keyframes slideInUp {
            from {
                transform: translateY(20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.05);
                opacity: 0.8;
            }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Focus states per accessibilità */
        .action-btn:focus,
        .subject-btn:focus,
        .control-btn:focus,
        .nav-btn:focus,
        .play-btn:focus,
        .fab-main:focus,
        .fab-item:focus,
        .toc-item:focus,
        .lesson-link:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }

        /* High contrast mode */
        @media (prefers-contrast: high) {
            :root {
                --border-color: #000000;
                --text-muted: #333333;
            }
        }

        /* Reduced motion */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-dark);
        }
    </style>
</head>
<body>
    <!-- Progress Bar -->
    <div class="progress-bar" id="progressBar" style="width: 0%"></div>

    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-top">
                <a href="#" class="logo">
                    <div class="logo-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <span>StudyHub</span>
                </a>

                <div class="header-actions">
                    <button class="action-btn" id="searchBtn" title="Cerca">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="action-btn" id="bookmarkBtn" title="Bookmark">
                        <i class="fas fa-bookmark"></i>
                    </button>
                    <button class="action-btn" id="themeBtn" title="Cambia tema">
                        <i class="fas fa-moon"></i>
                    </button>
                    <button class="action-btn" id="fullscreenBtn" title="Schermo intero">
                        <i class="fas fa-expand"></i>
                    </button>
                    <button class="action-btn" id="menuBtn" title="Menu">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
            </div>

            <nav class="nav-container">
                <div class="nav-subjects">
                    <button class="subject-btn active" data-section="index">
                        <i class="fas fa-home"></i>
                        <span>Indice</span>
                    </button>
                    <button class="subject-btn" data-section="italiano">
                        <i class="fas fa-book"></i>
                        <span>Italiano</span>
                    </button>
                    <button class="subject-btn" data-section="storia">
                        <i class="fas fa-landmark"></i>
                        <span>Storia</span>
                    </button>
                    <button class="subject-btn" data-section="matematica">
                        <i class="fas fa-calculator"></i>
                        <span>Matematica</span>
                    </button>
                    <button class="subject-btn" data-section="inglese">
                        <i class="fas fa-language"></i>
                        <span>Inglese</span>
                    </button>
                    <button class="subject-btn" data-section="psicologia">
                        <i class="fas fa-brain"></i>
                        <span>Psicologia</span>
                    </button>
                    <button class="subject-btn" data-section="pedagogia">
                        <i class="fas fa-users"></i>
                        <span>Pedagogia</span>
                    </button>
                    <button class="subject-btn" data-section="sociologia">
                        <i class="fas fa-globe"></i>
                        <span>Sociologia</span>
                    </button>
                    <button class="subject-btn" data-section="filosofia">
                        <i class="fas fa-lightbulb"></i>
                        <span>Filosofia</span>
                    </button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Main Container -->
    <main class="main-container">
        <div class="content-wrapper">
            <!-- Sidebar TOC -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <i class="fas fa-list"></i>
                    <span>Contenuti</span>
                </div>
                <div id="tocContainer">
                    <!-- TOC items will be generated dynamically -->
                </div>
            </aside>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Sezione Indice -->
                <section id="index" class="section active">
                    <div class="lesson-header">
                        <h1 class="lesson-title">📚 Benvenuto in StudyHub</h1>
                        <p class="lesson-subtitle">La tua guida completa per l'esame socio-psico-pedagogico</p>
                    </div>

                    <div class="card card-highlight">
                        <h3 class="card-title">🎯 Il tuo percorso di studio</h3>
                        <p>Questo ebook interattivo ti accompagnerà attraverso tutte le materie essenziali per l'esame di stato. Ogni sezione è progettata per offrirti contenuti chiari, esempi pratici e strumenti di studio avanzati.</p>
                    </div>

                    <div class="index-grid">
                        <div class="subject-card">
                            <div class="subject-card-header">
                                <div class="subject-icon">
                                    <i class="fas fa-book"></i>
                                </div>
                                <h3 class="subject-card-title">Italiano</h3>
                            </div>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione1">📚 Fondamenti della Letteratura Italiana</a>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione2">👤 Dante Alighieri - Divina Commedia</a>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione3">🌹 Petrarca - Il Canzoniere</a>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione4">📚 Boccaccio - Il Decameron</a>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione5">🏛️ Rinascimento - Machiavelli e Ariosto</a>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione6">🎭 Settecento - Goldoni, Parini, Alfieri</a>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione7">🌅 Romanticismo - Foscolo e Manzoni</a>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione8">🌙 Leopardi e Verismo - Verga</a>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione9">🌸 Decadentismo - Pascoli e D'Annunzio</a>
                            <a href="#" class="lesson-link" data-section="italiano" data-anchor="lezione10">🚀 Novecento - Pirandello e Svevo</a>
                        </div>

                        <div class="subject-card">
                            <div class="subject-card-header">
                                <div class="subject-icon">
                                    <i class="fas fa-landmark"></i>
                                </div>
                                <h3 class="subject-card-title">Storia</h3>
                            </div>
                            <a href="#" class="lesson-link" data-section="storia" data-anchor="storia-lezione1">🏛️ Alto Medioevo</a>
                            <a href="#" class="lesson-link" data-section="storia" data-anchor="storia-lezione2">🌱 Basso Medioevo</a>
                            <a href="#" class="lesson-link" data-section="storia" data-anchor="storia-lezione3">💀 Crisi del XIV Secolo</a>
                            <a href="#" class="lesson-link" data-section="storia" data-anchor="storia-lezione4">🎨 Rinascimento</a>
                            <a href="#" class="lesson-link" data-section="storia" data-anchor="storia-lezione5">👑 Seicento - Assolutismo</a>
                            <a href="#" class="lesson-link" data-section="storia" data-anchor="storia-lezione6">💡 Settecento - Illuminismo</a>
                            <a href="#" class="lesson-link" data-section="storia" data-anchor="storia-lezione7">🏰 Rivoluzione Francese</a>
                            <a href="#" class="lesson-link" data-section="storia" data-anchor="storia-lezione8">🎖️ Napoleone Bonaparte</a>
                        </div>

                        <div class="subject-card">
                            <div class="subject-card-header">
                                <div class="subject-icon">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <h3 class="subject-card-title">Psicologia</h3>
                            </div>
                            <a href="#" class="lesson-link" data-section="psicologia">🧠 Psicologia Generale</a>
                            <a href="#" class="lesson-link" data-section="psicologia">👶 Psicologia dello Sviluppo</a>
                            <a href="#" class="lesson-link" data-section="psicologia">👥 Psicologia Sociale</a>
                            <a href="#" class="lesson-link" data-section="psicologia">⚕️ Psicologia Applicata</a>
                        </div>

                        <div class="subject-card">
                            <div class="subject-card-header">
                                <div class="subject-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <h3 class="subject-card-title">Pedagogia</h3>
                            </div>
                            <a href="#" class="lesson-link" data-section="pedagogia">📚 Storia della Pedagogia</a>
                            <a href="#" class="lesson-link" data-section="pedagogia">🌟 Pedagogia Contemporanea</a>
                            <a href="#" class="lesson-link" data-section="pedagogia">♿ Pedagogia Speciale</a>
                            <a href="#" class="lesson-link" data-section="pedagogia">🌍 Pedagogia Interculturale</a>
                        </div>
                    </div>
                </section>

                <!-- Sezione Italiano -->
                <!-- Sezione Italiano Completa -->
<section id="italiano" class="section">
    <div class="lesson-content">
        <h2>📖 ITALIANO - Programma Completo per l'Esame</h2>

        <!-- LEZIONE 1: FONDAMENTI CON ANCHOR ID -->
        <div id="lezione1" class="lesson-content">
            <h2>📚 LEZIONE 1: I Fondamenti della Letteratura Italiana</h2>

            <div class="card card-tip">
                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                <p><strong>Cosa imparerai:</strong></p>
                <ul>
                    <li>Cos'è la letteratura e perché è importante</li>
                    <li>Le periodizzazioni della letteratura italiana</li>
                    <li>Come leggere e analizzare un testo letterario</li>
                    <li>I generi letterari principali</li>
                </ul>
            </div>

            <h3>📚 Che cos'è la Letteratura?</h3>
            <p>La <strong>letteratura</strong> è l'insieme delle opere scritte che hanno valore artistico e culturale. Non è solo "bella scrittura", ma è:</p>

            <div class="card">
                <ul>
                    <li><strong>Testimonianza storica:</strong> ci racconta come vivevano, pensavano e sentivano le persone del passato</li>
                    <li><strong>Arte del linguaggio:</strong> usa le parole per creare bellezza ed emozioni</li>
                    <li><strong>Riflessione sull'uomo:</strong> esplora i grandi temi universali (amore, morte, giustizia, senso della vita)</li>
                </ul>
            </div>

            <div class="card card-important">
                <h3 class="card-title">Perché studiare letteratura italiana?</h3>
                <ul>
                    <li>Per capire la nostra identità culturale</li>
                    <li>Per sviluppare il pensiero critico</li>
                    <li>Per migliorare le capacità espressive</li>
                    <li>Per l'esame!</li>
                </ul>
            </div>

            <h3>🗓️ Le Grandi Epoche della Letteratura Italiana</h3>

            <div class="card card-highlight">
                <h4><strong>1. MEDIOEVO (1200-1400)</strong></h4>
                <p><strong>Caratteristiche:</strong> religiosità, mondo feudale, latino e volgare</p>
                <p><strong>Autori chiave:</strong> Dante, Petrarca, Boccaccio</p>
                <p><strong>Perché è importante:</strong> nascono l'italiano letterario e i grandi modelli</p>
            </div>

            <div class="card card-highlight">
                <h4><strong>2. RINASCIMENTO (1400-1600)</strong></h4>
                <p><strong>Caratteristiche:</strong> riscoperta dei classici, corti signorili, umanesimo</p>
                <p><strong>Autori chiave:</strong> Ariosto, Machiavelli, Tasso</p>
                <p><strong>Perché è importante:</strong> l'italiano diventa lingua letteraria matura</p>
            </div>

            <div class="card card-highlight">
                <h4><strong>3. BAROCCO E NEOCLASSICISMO (1600-1700)</strong></h4>
                <p><strong>Caratteristiche:</strong> ricerca del "meraviglioso", poi ritorno alla semplicità</p>
                <p><strong>Autori chiave:</strong> Marino, Goldoni, Parini, Alfieri</p>
                <p><strong>Perché è importante:</strong> transizione verso la modernità</p>
            </div>

            <div class="card card-highlight">
                <h4><strong>4. ROMANTICISMO (1800)</strong></h4>
                <p><strong>Caratteristiche:</strong> sentimento, nazione, storia, natura</p>
                <p><strong>Autori chiave:</strong> Foscolo, Manzoni, Leopardi</p>
                <p><strong>Perché è importante:</strong> letteratura dell'Italia unita</p>
            </div>

            <div class="card card-highlight">
                <h4><strong>5. REALISMO E DECADENTISMO (fine 1800 - inizio 1900)</strong></h4>
                <p><strong>Caratteristiche:</strong> verità sociale vs crisi dei valori</p>
                <p><strong>Autori chiave:</strong> Verga, Pascoli, D'Annunzio</p>
                <p><strong>Perché è importante:</strong> verso la letteratura contemporanea</p>
            </div>

            <h3>📖 I Generi Letterari</h3>

            <div class="card card-tip">
                <h4><strong>EPICA</strong></h4>
                <p><strong>Cos'è:</strong> racconta le gesta di eroi, spesso con elementi fantastici</p>
                <p><strong>Esempi:</strong> Divina Commedia, Orlando Furioso</p>
            </div>

            <div class="card card-tip">
                <h4><strong>LIRICA</strong></h4>
                <p><strong>Cos'è:</strong> esprime sentimenti ed emozioni personali</p>
                <p><strong>Esempi:</strong> sonetti di Petrarca, poesie di Leopardi</p>
            </div>

            <div class="card card-tip">
                <h4><strong>NARRATIVA</strong></h4>
                <p><strong>Cos'è:</strong> racconta una storia con personaggi e vicende</p>
                <p><strong>Esempi:</strong> Promessi Sposi, novelle di Boccaccio</p>
            </div>

            <div class="card card-tip">
                <h4><strong>TEATRO</strong></h4>
                <p><strong>Cos'è:</strong> testi scritti per essere rappresentati</p>
                <p><strong>Esempi:</strong> commedie di Goldoni, tragedie di Alfieri</p>
            </div>

            <h3>🔍 Come Analizzare un Testo Letterario</h3>

            <div class="card card-important">
                <h4><strong>PRIMO LIVELLO: COMPRENSIONE</strong></h4>
                <ol>
                    <li><strong>Chi</strong> parla nel testo?</li>
                    <li><strong>Di cosa</strong> si parla?</li>
                    <li><strong>Quando</strong> e <strong>dove</strong> è ambientato?</li>
                    <li><strong>Cosa</strong> succede?</li>
                </ol>
            </div>

            <div class="card card-important">
                <h4><strong>SECONDO LIVELLO: ANALISI</strong></h4>
                <ol>
                    <li><strong>Linguaggio:</strong> parole difficili, figure retoriche</li>
                    <li><strong>Struttura:</strong> come è organizzato il testo</li>
                    <li><strong>Stile:</strong> come scrive l'autore</li>
                    <li><strong>Temi:</strong> i messaggi profondi</li>
                </ol>
            </div>

            <div class="card card-important">
                <h4><strong>TERZO LIVELLO: INTERPRETAZIONE</strong></h4>
                <ol>
                    <li><strong>Perché</strong> l'autore ha scritto questo testo?</li>
                    <li><strong>Che rapporto</strong> ha con il suo tempo?</li>
                    <li><strong>Cosa</strong> ci dice ancora oggi?</li>
                </ol>
            </div>
        </div>

        <!-- LEZIONE 2: DANTE CON ANCHOR ID -->
        <div id="lezione2" class="lesson-content">
            <h2>👤 LEZIONE 2: Dante Alighieri - Il Padre della Letteratura Italiana</h2>

            <div class="card card-tip">
                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                <p><strong>Oggi imparerai:</strong></p>
                <ul>
                    <li>Chi era Dante e perché è così importante</li>
                    <li>La struttura e il significato della Divina Commedia</li>
                    <li>Come leggere e interpretare i canti più famosi</li>
                    <li>Il linguaggio e lo stile dantesco</li>
                </ul>
            </div>

            <h3>👤 Dante Alighieri (1265-1321): L'Uomo e il Poeta</h3>

            <div class="card card-highlight">
                <h4><strong>LA VITA</strong></h4>
                <ul>
                    <li><strong>Firenze 1265:</strong> nasce in una famiglia della piccola nobiltà guelfa</li>
                    <li><strong>1274:</strong> incontra Beatrice (Bice Portinari) - amore della sua vita</li>
                    <li><strong>1290:</strong> muore Beatrice - svolta nella sua poetica</li>
                    <li><strong>1300:</strong> priore di Firenze, si oppone al papa Bonifacio VIII</li>
                    <li><strong>1302:</strong> esilio da Firenze per sempre - non vi tornerà mai più</li>
                    <li><strong>1321:</strong> muore a Ravenna, ancora in esilio</li>
                </ul>
            </div>

            <div class="card card-important">
                <h4><strong>PERCHÉ È IMPORTANTE?</strong></h4>
                <ul>
                    <li><strong>Crea l'italiano letterario:</strong> usa il volgare fiorentino per opere "alte"</li>
                    <li><strong>Sintesi medievale:</strong> unisce cultura classica, filosofia e teologia cristiana</li>
                    <li><strong>Poeta universale:</strong> i suoi temi parlano ancora oggi</li>
                    <li><strong>Padre della patria letteraria:</strong> tutti gli autori italiani dopo di lui si confrontano con Dante</li>
                </ul>
            </div>

            <h3>📖 La Divina Commedia: L'Opera Immortale</h3>

            <div class="card card-important">
                <h4><strong>STRUTTURA MATEMATICA</strong></h4>
                <ul>
                    <li><strong>3 cantiche:</strong> Inferno, Purgatorio, Paradiso</li>
                    <li><strong>33 canti</strong> per cantica + 1 di introduzione = 100 canti totali</li>
                    <li><strong>Terzine</strong> di endecasillabi (ABA BCB CDC...)</li>
                    <li><strong>Numero 3:</strong> simbolo della Trinità, perfezione divina</li>
                </ul>
            </div>

            <h4>🔥 L'Inferno: Geografia e Legge del Contrappasso</h4>

            <div class="card card-tip">
                <h4><strong>I CERCHI PRINCIPALI</strong></h4>
                <ol>
                    <li><strong>Limbo:</strong> spiriti magni non battezzati</li>
                    <li><strong>Lussuriosi:</strong> trascinati dal vento (Paolo e Francesca)</li>
                    <li><strong>Golosi:</strong> immersi nel fango</li>
                    <li><strong>Avari e prodighi:</strong> spingono massi</li>
                    <li><strong>Iracondi:</strong> combattono nelle acque</li>
                    <li><strong>Eretici:</strong> sepolti in tombe infuocate</li>
                    <li><strong>Violenti:</strong> immersi nel Flegetonte</li>
                    <li><strong>Fraudolenti:</strong> 10 bolge diverse</li>
                    <li><strong>Traditori:</strong> congelati nel Cocito</li>
                </ol>
            </div>

            <h4>📚 Analisi: Canto I - "Nel mezzo del cammin"</h4>

            <div class="card card-highlight">
                <blockquote>
                    <p><em>"Nel mezzo del cammin di nostra vita<br>
                    mi ritrovai per una selva oscura,<br>
                    ché la diritta via era smarrita."</em></p>
                </blockquote>

                <h4><strong>ANALISI:</strong></h4>
                <ul>
                    <li><strong>"Nel mezzo del cammin":</strong> 35 anni, crisi esistenziale universale</li>
                    <li><strong>"nostra vita":</strong> coinvolge tutti noi lettori</li>
                    <li><strong>"selva oscura":</strong> simbolo del peccato, smarrimento morale</li>
                    <li><strong>"diritta via":</strong> la strada della virtù, la via di Dio</li>
                </ul>
            </div>

            <h4>📚 Canto V dell'Inferno - Paolo e Francesca</h4>

            <div class="card card-tip">
                <h4><strong>LA SITUAZIONE</strong></h4>
                <ul>
                    <li><strong>II cerchio:</strong> lussuriosi trascinati dalla bufera infernale</li>
                    <li><strong>Contrappasso:</strong> come in vita si lasciarono trascinare dalla passione, ora sono trascinati dal vento per l'eternità</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>I PERSONAGGI</strong></h4>
                <ul>
                    <li><strong>Francesca da Rimini:</strong> sposata per ragioni politiche con Gianciotto Malatesta</li>
                    <li><strong>Paolo:</strong> fratello del marito, innamorato di Francesca</li>
                    <li><strong>La scoperta:</strong> il marito li sorprende e li uccide (1285 circa)</li>
                </ul>
            </div>

            <h4>🧊 Canto XXXIII dell'Inferno - Il Conte Ugolino</h4>

            <div class="card card-important">
                <h4><strong>LA SITUAZIONE</strong></h4>
                <ul>
                    <li><strong>Nono cerchio:</strong> ghiaccio del Cocito (traditori)</li>
                    <li><strong>Ugolino della Gherardesca:</strong> rosicchia il cranio dell'Arcivescovo Ruggieri</li>
                    <li><strong>Contrappasso:</strong> come tradì, ora è tradito</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>IL RACCONTO DRAMMATICO</strong></h4>
                <blockquote>
                    <p><em>"La bocca sollevò dal fiero pasto<br>
                    quel peccator, forbendola a' capelli<br>
                    del capo ch'elli avea di retro guasto."</em></p>
                </blockquote>

                <h4><strong>TECNICHE NARRATIVE:</strong></h4>
                <ul>
                    <li><strong>Suspense:</strong> graduale rivelazione</li>
                    <li><strong>Realismo drammatico:</strong> ogni dettaglio conta</li>
                    <li><strong>Pietà umana:</strong> padre disperato oltre che traditore</li>
                    <li><strong>Finale ambiguo:</strong> "Poscia, più che 'l dolor, poté 'l digiuno"</li>
                </ul>
            </div>

            <h3>☀️ Il Paradiso - Il Regno della Luce</h3>
            <div class="card card-tip">
                <h4><strong>STRUTTURA</strong></h4>
                <ul>
                    <li><strong>9 cieli:</strong> Luna, Mercurio, Venere, Sole, Marte, Giove, Saturno, Stelle fisse, Primo Mobile</li>
                    <li><strong>Empireo:</strong> sede di Dio, rosa dei beati</li>
                    <li><strong>Temi:</strong> luce (simbolo di Dio), amore (forza cosmica), giustizia divina</li>
                </ul>
            </div>
        </div>

        <!-- LEZIONE 3: PETRARCA CON ANCHOR ID -->
        <div id="lezione3" class="lesson-content">
            <h2>🌹 LEZIONE 3: Francesco Petrarca - Il Poeta dell'Io</h2>

            <div class="card card-important">
                <h4><strong>LA VITA (1304-1374)</strong></h4>
                <ul>
                    <li>Nasce ad Arezzo, studia ad Avignone</li>
                    <li>1327: incontra Laura in chiesa</li>
                    <li>Vita itinerante tra corti europee</li>
                    <li>1341: incoronato poeta laureato a Roma</li>
                    <li>Muore ad Arquà sui Colli Euganei</li>
                </ul>
            </div>

            <h3>📖 Il Canzoniere</h3>
            <p>Raccolta di <strong>366 componimenti</strong> (366 come i giorni dell'anno bisestile) dedicati all'amore per Laura.</p>

            <div class="card card-tip">
                <h4><strong>STRUTTURA</strong></h4>
                <ul>
                    <li><strong>Rime in vita di Laura:</strong> primi 263 componimenti</li>
                    <li><strong>Rime in morte di Laura:</strong> ultimi 103 componimenti</li>
                    <li><strong>Generi:</strong> principalmente sonetti, alcune canzoni</li>
                    <li><strong>Tema unificante:</strong> amore per Laura come percorso spirituale</li>
                </ul>
            </div>

            <h4>Analisi: "Voi ch'ascoltate" (Sonetto I)</h4>
            <div class="card card-highlight">
                <blockquote>
                    <p><em>"Voi ch'ascoltate in rime sparse il suono<br>
                    di quei sospiri ond'io nudriva 'l core<br>
                    in sul mio primo giovenile errore<br>
                    quand'era in parte altr'uom da quel ch'i' sono"</em></p>
                </blockquote>

                <h4><strong>ANALISI:</strong></h4>
                <ul>
                    <li><strong>"rime sparse":</strong> frammenti dell'anima</li>
                    <li><strong>"primo giovenile errore":</strong> l'amore come smarrimento</li>
                    <li><strong>"altr'uom":</strong> pentimento, evoluzione spirituale</li>
                    <li><strong>Funzione:</strong> proemio che presenta l'intera raccolta</li>
                </ul>
            </div>
        </div>

        <!-- LEZIONE 4: BOCCACCIO CON ANCHOR ID -->
        <div id="lezione4" class="lesson-content">
            <h2>📚 LEZIONE 4: Ugolino, il Paradiso e Giovanni Boccaccio</h2>

            <div class="card card-tip">
                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                <p><strong>Oggi imparerai:</strong></p>
                <ul>
                    <li>Il Canto XXXIII dell'Inferno: la tragedia di Ugolino</li>
                    <li>Il Paradiso: struttura e temi fondamentali</li>
                    <li>Giovanni Boccaccio e la rivoluzione della prosa</li>
                    <li>Il Decameron: struttura, temi e stile</li>
                </ul>
            </div>

            <h3>📖 Giovanni Boccaccio (1313-1375)</h3>
            <p><strong>Il Decameron:</strong> 100 novelle raccontate in 10 giorni da 10 giovani che fuggono dalla peste del 1348.</p>

            <div class="card card-important">
                <h4><strong>STRUTTURA DEL DECAMERON</strong></h4>
                <ul>
                    <li><strong>Cornice narrativa:</strong> 10 giovani, 10 giorni</li>
                    <li><strong>100 novelle:</strong> 10 per giorno</li>
                    <li><strong>Temi delle giornate:</strong> vari (amori, beffa, virtù)</li>
                    <li><strong>Innovazione:</strong> realismo borghese, varietà di personaggi</li>
                </ul>
            </div>

            <h4>Analisi: Lisabetta da Messina (IV, 5)</h4>

            <div class="card card-highlight">
                <h4><strong>LA TRAMA</strong></h4>
                <ul>
                    <li><strong>Lisabetta:</strong> innamorata di Lorenzo, garzone dei fratelli</li>
                    <li><strong>I fratelli:</strong> scoprono l'amore e uccidono Lorenzo</li>
                    <li><strong>Il sogno:</strong> Lorenzo appare a Lisabetta e rivela dove è sepolto</li>
                    <li><strong>Il basilico:</strong> Lisabetta dissotterra la testa e la nasconde in un vaso</li>
                    <li><strong>La morte:</strong> consumata dal dolore, muore sulla pianta</li>
                </ul>
            </div>

            <div class="card card-tip">
                <h4><strong>I TIPI UMANI DEL DECAMERON</strong></h4>
                <ul>
                    <li><strong>Mercanti:</strong> protagonisti del mondo borghese, intelligenza pratica</li>
                    <li><strong>Ecclesiastici:</strong> spesso corrotti, satira anticlericale</li>
                    <li><strong>Donne:</strong> protagoniste attive, non passive come nella tradizione</li>
                    <li><strong>Popolani:</strong> mondo contadino, astuzia e vitalità naturale</li>
                </ul>
            </div>

            <div class="card card-important">
                <h4><strong>LA VISIONE DEL MONDO</strong></h4>
                <ul>
                    <li><strong>Fortuna:</strong> forza cieca che può elevare o abbattere chiunque</li>
                    <li><strong>Amore:</strong> forza naturale, istinto positivo, non peccato</li>
                    <li><strong>Intelligenza:</strong> virtù suprema, più importante della nascita</li>
                </ul>
            </div>
        </div>

        <!-- LEZIONE 5: RINASCIMENTO CON ANCHOR ID -->
        <div id="lezione5" class="lesson-content">
            <h2>🏛️ LEZIONE 5: Rinascimento - Niccolò Machiavelli e Ludovico Ariosto</h2>

            <div class="card card-tip">
                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                <p><strong>Oggi imparerai:</strong></p>
                <ul>
                    <li>Il contesto storico-culturale del Rinascimento</li>
                    <li>Niccolò Machiavelli: Il Principe e la nuova concezione della politica</li>
                    <li>Ludovico Ariosto: Orlando Furioso e il poema cavalleresco</li>
                    <li>Le differenze tra mondo medievale e rinascimentale</li>
                </ul>
            </div>

            <h3>🏛️ IL RINASCIMENTO (1400-1600): Una Nuova Epoca</h3>

            <div class="card card-highlight">
                <h4><strong>LA RIVOLUZIONE CULTURALE</strong></h4>
                <ul>
                    <li><strong>Umanesimo:</strong> riscoperta dei classici latini e greci</li>
                    <li><strong>Antropocentrismo:</strong> l'uomo al centro, non più Dio</li>
                    <li><strong>Individualismo:</strong> valorizzazione della personalità</li>
                    <li><strong>Laicizzazione:</strong> cultura indipendente dalla Chiesa</li>
                    <li><strong>Metodo filologico:</strong> studio critico dei testi antichi</li>
                </ul>
            </div>

            <h3>⚔️ NICCOLÒ MACHIAVELLI (1469-1527): Il Realista della Politica</h3>

            <div class="card card-important">
                <h4><strong>IL PRINCIPE - Concetti fondamentali</strong></h4>
                <ul>
                    <li><strong>Verità effettuale:</strong> osservare i fatti, non i doveri morali</li>
                    <li><strong>Virtù vs Fortuna:</strong> capacità politica contro il caso</li>
                    <li><strong>Il principe ideale:</strong> deve essere "volpe e leone"</li>
                    <li><strong>Fine e mezzi:</strong> il fine (salvare lo stato) giustifica i mezzi</li>
                </ul>
            </div>

            <h3>🏰 LUDOVICO ARIOSTO (1474-1533): Il Poeta della Corte</h3>

            <div class="card card-tip">
                <h4><strong>ORLANDO FURIOSO</strong></h4>
                <ul>
                    <li><strong>46 canti</strong> in ottave</li>
                    <li><strong>Continuazione</strong> dell'Orlando Innamorato di Boiardo</li>
                    <li><strong>Temi:</strong> amore (fa impazzire), guerra, follia</li>
                    <li><strong>Tecnica:</strong> entrelacement (intreccio di storie)</li>
                    <li><strong>Stile:</strong> ironia, distacco dal mondo cavalleresco</li>
                </ul>
            </div>

            <h4>Analisi: Il Proemio</h4>
            <div class="card card-highlight">
                <blockquote>
                    <p><em>"Le donne, i cavallier, l'arme, gli amori,<br>
                    le cortesie, l'audaci imprese io canto"</em></p>
                </blockquote>

                <h4><strong>ANALISI:</strong></h4>
                <ul>
                    <li><strong>"Le donne, i cavallier, l'arme, gli amori":</strong> i quattro temi del poema</li>
                    <li><strong>Ordine significativo:</strong> prima l'amore, poi la guerra</li>
                    <li><strong>"cortesie, audaci imprese":</strong> mondo cavalleresco</li>
                    <li><strong>Schema epico:</strong> vendetta (Troiano ucciso da Orlando)</li>
                </ul>
            </div>
        </div>

        <!-- LEZIONE 6: SETTECENTO CON ANCHOR ID -->
        <div id="lezione6" class="lesson-content">
            <h2>🎭 LEZIONE 6: Dal Barocco all'Illuminismo - Goldoni, Parini, Alfieri</h2>

            <div class="card card-tip">
                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                <p><strong>Oggi imparerai:</strong></p>
                <ul>
                    <li>Il Barocco e la crisi del Seicento</li>
                    <li>Carlo Goldoni e la riforma del teatro</li>
                    <li>Giuseppe Parini e la satira illuminista</li>
                    <li>Vittorio Alfieri e la tragedia neoclassica</li>
                </ul>
            </div>

            <h3>🌀 Il Barocco (1600)</h3>
            <div class="card card-highlight">
                <h4><strong>CARATTERISTICHE</strong></h4>
                <ul>
                    <li><strong>Meraviglia:</strong> stupire a tutti i costi</li>
                    <li><strong>Artificio:</strong> tecnica virtuosistica</li>
                    <li><strong>Marino:</strong> "È del poeta il fin la meraviglia"</li>
                </ul>
            </div>

            <h3>🎭 Carlo Goldoni (1707-1793)</h3>

            <div class="card card-important">
                <h4><strong>LA RIFORMA DEL TEATRO</strong></h4>
                <ul>
                    <li><strong>Prima:</strong> Commedia dell'Arte (improvvisazione, maschere)</li>
                    <li><strong>Dopo:</strong> testo scritto, caratteri umani, lingua italiana</li>
                    <li><strong>Capolavoro:</strong> "La Locandiera" (Mirandolina protagonista moderna)</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>"LA LOCANDIERA" - Analisi</strong></h4>
                <ul>
                    <li><strong>Mirandolina:</strong> giovane locandiera furba e indipendente</li>
                    <li><strong>Tre pretendenti:</strong> Marchese, Conte, Cavaliere</li>
                    <li><strong>Sviluppo:</strong> Mirandolina conquista il misogino Cavaliere</li><li><strong>Finale:</strong> sposa Fabrizio, il cameriere che ama davvero</li>
                </ul>
            </div>

            <h3>🏛️ Giuseppe Parini (1729-1799)</h3>
            <div class="card card-tip">
                <h4><strong>"IL GIORNO"</strong></h4>
                <ul>
                    <li>Satira dell'aristocrazia parassita</li>
                    <li>Ironia: finta celebrazione che è condanna</li>
                    <li>Morale illuminista: tutti devono essere utili</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>Analisi: L'inizio del "Mattino"</strong></h4>
                <blockquote>
                    <p><em>"Giovin Signore, o a te scenda per lungo<br>
                    di magnanimi lombi ordine il sangue<br>
                    purissimo celeste"</em></p>
                </blockquote>

                <h4><strong>ANALISI:</strong></h4>
                <ul>
                    <li><strong>Ironia dell'inizio:</strong> finta celebrazione della nobiltà</li>
                    <li><strong>"magnanimi lombi":</strong> perifrasi ironica per antenati</li>
                    <li><strong>"sangue purissimo celeste":</strong> ironia sulla nobiltà di sangue</li>
                    <li><strong>Stile alto:</strong> per argomento basso (contrasto ironico)</li>
                </ul>
            </div>

            <h3>⚔️ Vittorio Alfieri (1749-1803)</h3>
            <div class="card card-highlight">
                <h4><strong>LE TRAGEDIE</strong></h4>
                <ul>
                    <li><strong>Tema centrale:</strong> libertà vs tirannia</li>
                    <li><strong>Capolavoro:</strong> "Saul" (re tormentato)</li>
                    <li><strong>Eroe titanico:</strong> lotta contro destino avverso</li>
                </ul>
            </div>

            <div class="card card-tip">
                <h4><strong>SAUL - Il personaggio</strong></h4>
                <ul>
                    <li><strong>Gigante tragico:</strong> passioni enormi, destino terribile</li>
                    <li><strong>Lacerazione interiore:</strong> tra amore paterno e gelosia politica</li>
                    <li><strong>Solitudine:</strong> abbandonato da Dio e dagli uomini</li>
                    <li><strong>Morte eroica:</strong> preferisce morire da re</li>
                </ul>
            </div>
        </div>

        <!-- LEZIONE 7: ROMANTICISMO CON ANCHOR ID -->
        <div id="lezione7" class="lesson-content">
            <h2>🌅 LEZIONE 7: Il Romanticismo - Ugo Foscolo e Alessandro Manzoni</h2>

            <div class="card card-tip">
                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                <p><strong>Oggi imparerai:</strong></p>
                <ul>
                    <li>Il Romanticismo europeo e italiano</li>
                    <li>Ugo Foscolo: tra Neoclassicismo e Romanticismo</li>
                    <li>Alessandro Manzoni: il poeta cristiano del Romanticismo</li>
                    <li>I Promessi Sposi e la nascita del romanzo moderno italiano</li>
                </ul>
            </div>

            <h3>🌅 IL ROMANTICISMO (1800-1850)</h3>

            <div class="card card-important">
                <h4><strong>CARATTERISTICHE</strong></h4>
                <ul>
                    <li><strong>Sentimento vs ragione:</strong> il cuore prima della mente</li>
                    <li><strong>Soggettivismo:</strong> l'io al centro dell'arte</li>
                    <li><strong>Nazionalismo:</strong> ogni popolo ha una sua cultura</li>
                    <li><strong>Storicismo:</strong> interesse per il passato</li>
                </ul>
            </div>

            <h3>🗡️ Ugo Foscolo (1778-1827)</h3>

            <div class="card card-highlight">
                <h4><strong>OPERE PRINCIPALI</strong></h4>
                <ul>
                    <li><strong>"Ultime lettere di Jacopo Ortis":</strong> primo romanzo moderno italiano</li>
                    <li><strong>Sonetti:</strong> "A Zacinto", "Alla sera", "In morte del fratello Giovanni"</li>
                    <li><strong>"Dei Sepolcri":</strong> carme civile sulla funzione delle tombe</li>
                </ul>
            </div>

            <h4>Analisi: "A Zacinto"</h4>
            <div class="card card-tip">
                <blockquote>
                    <p><em>"Né più mai toccherò le sacre sponde<br>
                    ove il mio corpo fanciulletto giacque..."</em></p>
                </blockquote>

                <h4><strong>TEMI:</strong></h4>
                <ul>
                    <li><strong>Esilio:</strong> condizione esistenziale del moderno</li>
                    <li><strong>Memoria:</strong> unico legame con la patria</li>
                    <li><strong>Mito:</strong> Ulisse come archetipo dell'esule</li>
                </ul>
            </div>

            <h3>✝️ Alessandro Manzoni (1785-1873)</h3>

            <div class="card card-important">
                <h4><strong>POETICA MANZONIANA</strong></h4>
                <ul>
                    <li><strong>Vero storico:</strong> raccontare fatti realmente accaduti</li>
                    <li><strong>Verosimile:</strong> quello che poteva accadere</li>
                    <li><strong>Utile:</strong> l'arte deve educare moralmente</li>
                    <li><strong>Cristianesimo:</strong> provvidenza divina nella storia</li>
                </ul>
            </div>

            <h4>📖 I Promessi Sposi</h4>
            <div class="card card-highlight">
                <h4><strong>PERSONAGGI PRINCIPALI</strong></h4>
                <ul>
                    <li><strong>Renzo:</strong> popolano che diventa uomo maturo</li>
                    <li><strong>Lucia:</strong> simbolo di purezza e fede</li>
                    <li><strong>Don Abbondio:</strong> prete pauroso</li>
                    <li><strong>Don Rodrigo:</strong> signorotto prepotente</li>
                    <li><strong>Innominato:</strong> conversione come possibilità per tutti</li>
                </ul>
            </div>

            <div class="card card-tip">
                <h4><strong>I TEMI FONDAMENTALI</strong></h4>
                <ul>
                    <li><strong>La Provvidenza:</strong> Dio guida la storia</li>
                    <li><strong>Oppressi vs oppressori:</strong> costante della storia</li>
                    <li><strong>L'amore:</strong> sentimento puro tra Renzo e Lucia</li>
                    <li><strong>La giustizia:</strong> i malvagi sono puniti, i buoni premiati</li>
                </ul>
            </div>
        </div>

        <!-- LEZIONE 8: LEOPARDI E VERGA CON ANCHOR ID -->
        <div id="lezione8" class="lesson-content">
            <h2>🌙 LEZIONE 8: Giacomo Leopardi e il Verismo di Giovanni Verga</h2>

            <div class="card card-tip">
                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                <p><strong>Oggi imparerai:</strong></p>
                <ul>
                    <li>Giacomo Leopardi: il pessimismo e la poesia pura</li>
                    <li>L'evoluzione del pensiero leopardiano</li>
                    <li>Giovanni Verga e il Verismo italiano</li>
                    <li>Le tecniche narrative del realismo</li>
                </ul>
            </div>

            <h3>🌙 Giacomo Leopardi (1798-1837)</h3>

            <div class="card card-important">
                <h4><strong>EVOLUZIONE DEL PESSIMISMO</strong></h4>
                <ul>
                    <li><strong>Pessimismo storico:</strong> Natura benigna, ragione nemica</li>
                    <li><strong>Pessimismo cosmico:</strong> Natura matrigna, infelicità universale</li>
                    <li><strong>Pessimismo eroico:</strong> solidarietà umana contro il destino</li>
                </ul>
            </div>

            <h4>Analisi: "L'Infinito"</h4>
            <div class="card card-highlight">
                <blockquote>
                    <p><em>"Sempre caro mi fu quest'ermo colle,<br>
                    e questa siepe, che da tanta parte<br>
                    dell'ultimo orizzonte il guardo esclude..."</em></p>
                </blockquote>

                <h4><strong>TEMI:</strong></h4>
                <ul>
                    <li><strong>Infinito spaziale:</strong> oltre la siepe</li>
                    <li><strong>Infinito temporale:</strong> eterno vs presente</li>
                    <li><strong>Immaginazione:</strong> più forte della realtà</li>
                    <li><strong>"il naufragar m'è dolce":</strong> dolce perdita di sé</li>
                </ul>
            </div>

            <h4>Analisi: "A Silvia"</h4>
            <div class="card card-tip">
                <blockquote>
                    <p><em>"Silvia, rimembri ancora<br>
                    quel tempo della tua vita mortale,<br>
                    quando beltà splendea<br>
                    negli occhi tuoi ridenti e fuggitivi"</em></p>
                </blockquote>

                <h4><strong>TEMI:</strong></h4>
                <ul>
                    <li><strong>Memoria:</strong> unico modo per recuperare la felicità</li>
                    <li><strong>Giovinezza:</strong> età delle illusioni</li>
                    <li><strong>Morte:</strong> distrugge ogni speranza</li>
                    <li><strong>Natura matrigna:</strong> promette ma non mantiene</li>
                </ul>
            </div>

            <h3>🏔️ Giovanni Verga (1840-1922)</h3>

            <div class="card card-tip">
                <h4><strong>IL VERISMO ITALIANO</strong></h4>
                <ul>
                    <li><strong>Impersonalità:</strong> l'autore non deve apparire</li>
                    <li><strong>Regressione:</strong> adottare il punto di vista dei personaggi</li>
                    <li><strong>Linguaggio popolare:</strong> dialettismi, modi di dire</li>
                    <li><strong>Darwinismo sociale:</strong> lotta per la sopravvivenza</li>
                </ul>
            </div>

            <h4>"I Malavoglia" - L'ideale dell'ostrica</h4>
            <div class="card card-important">
                <blockquote>
                    <p><em>"Bisogna fare come fanno le ostriche, che si attaccano allo scoglio"</em></p>
                </blockquote>

                <h4><strong>TEMI:</strong></h4>
                <ul>
                    <li><strong>Resistenza passiva:</strong> non ribellarsi al destino</li>
                    <li><strong>Tradizione vs progresso:</strong> mondo antico che scompare</li>
                    <li><strong>La roba:</strong> tutto ridotto a valore economico</li>
                </ul>
            </div>

            <h4>Analisi: "Rosso Malpelo"</h4>
            <div class="card card-highlight">
                <h4><strong>IL PROTAGONISTA</strong></h4>
                <ul>
                    <li><strong>Vittima del pregiudizio:</strong> tutti lo credono cattivo per i capelli rossi</li>
                    <li><strong>Interiorizzazione:</strong> finisce per crederci anche lui</li>
                    <li><strong>Violenza:</strong> risultato dell'ambiente, non della natura</li>
                    <li><strong>Solitudine:</strong> escluso da tutti, anche dalla madre</li>
                </ul>
            </div>
        </div>

        <!-- LEZIONE 9: DECADENTISMO CON ANCHOR ID -->
        <div id="lezione9" class="lesson-content">
            <h2>🌸 LEZIONE 9: Il Decadentismo - Giovanni Pascoli e Gabriele D'Annunzio</h2>

            <div class="card card-tip">
                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                <p><strong>Cosa imparerai:</strong></p>
                <ul>
                    <li>Il Decadentismo europeo e italiano</li>
                    <li>Giovanni Pascoli: la poetica del fanciullino</li>
                    <li>Gabriele D'Annunzio: estetismo e superuomo</li>
                    <li>Le innovazioni stilistiche della poesia simbolista</li>
                </ul>
            </div>

            <h3>🌅 IL DECADENTISMO (1880-1920): La Crisi della Modernità</h3>

            <div class="card card-important">
                <h4><strong>IL CONTESTO STORICO-CULTURALE</strong></h4>
                <h5><strong>LA BELLE ÉPOQUE</strong></h5>
                <ul>
                    <li><strong>Crescita economica:</strong> industrializzazione, urbanizzazione</li>
                    <li><strong>Fiducia nel progresso:</strong> scienza, tecnologia, democrazia</li>
                    <li><strong>Benessere borghese:</strong> ma anche contraddizioni sociali</li>
                    <li><strong>Imperialismo:</strong> espansione coloniale europea</li>
                    <li><strong>Tensioni:</strong> che porteranno alla Prima Guerra Mondiale</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>LA CRISI DELLA CULTURA POSITIVISTA</strong></h4>
                <ul>
                    <li><strong>Scienza limitata:</strong> non può spiegare tutto</li>
                    <li><strong>Ragione insufficiente:</strong> esistono zone d'ombra dell'animo</li>
                    <li><strong>Progresso ambiguo:</strong> porta anche alienazione e massificazione</li>
                    <li><strong>Valori in crisi:</strong> religione, famiglia, patria perdono forza</li>
                    <li><strong>Relativismo:</strong> nessuna verità assoluta</li>
                </ul>
            </div>

            <h4>Caratteristiche del Decadentismo</h4>

            <div class="card card-tip">
                <h4><strong>TEMI FONDAMENTALI</strong></h4>
                <ul>
                    <li><strong>Irrazionalismo:</strong> privilegio dell'istinto sulla ragione</li>
                    <li><strong>Soggettivismo:</strong> l'io come centro dell'arte</li>
                    <li><strong>Estetismo:</strong> l'arte per l'arte, culto della bellezza</li>
                    <li><strong>Simbolismo:</strong> la realtà nasconde significati misteriosi</li>
                    <li><strong>Vitalismo:</strong> esaltazione degli istinti e delle passioni</li>
                    <li><strong>Decadenza:</strong> fascino per la corruzione e la raffinatezza</li>
                </ul>
            </div>

            <h3>🐣 GIOVANNI PASCOLI (1855-1912): Il Poeta del Nido</h3>

            <div class="card card-important">
                <h4><strong>IL TRAUMA ORIGINARIO</strong></h4>
                <ul>
                    <li><strong>1855:</strong> nasce a San Mauro di Romagna da famiglia benestante</li>
                    <li><strong>10 agosto 1867:</strong> il padre Ruggero viene ucciso (mai trovato il colpevole)</li>
                    <li><strong>Disgregazione familiare:</strong> morte della madre, del fratello Luigi</li>
                    <li><strong>Orfanezza:</strong> trauma che segnerà tutta la vita e la poesia</li>
                </ul>
            </div>

            <h4>La Poetica del Fanciullino</h4>

            <div class="card card-highlight">
                <h4><strong>IL SAGGIO (1897)</strong></h4>
                <blockquote>
                    <p><em>"È dentro noi un fanciullino che non solo ha brividi [...] ma lagrime ancora e tripudi suoi. Quando la nostra età è tuttavia tenera, egli confonde la sua voce con la nostra [...]. Ma quindi noi cresciamo, ed egli resta piccolo"</em></p>
                </blockquote>
            </div>

            <div class="card card-tip">
                <h4><strong>I PRINCIPI FONDAMENTALI</strong></h4>
                <h5><strong>IL FANCIULLINO INTERIORE</strong></h5>
                <ul>
                    <li><strong>Parte istintiva:</strong> dell'animo umano, pre-razionale</li>
                    <li><strong>Capacità di stupore:</strong> vede il mondo sempre per la prima volta</li>
                    <li><strong>Innocenza:</strong> non contaminata dalla razionalità adulta</li>
                    <li><strong>Analogie:</strong> coglie corrispondenze misteriose</li>
                    <li><strong>Linguaggio poetico:</strong> spontaneo, non artificioso</li>
                </ul>
            </div>

            <h4>📚 Analisi: "X Agosto" (1896)</h4>

            <div class="card card-highlight">
                <h4><strong>IL TESTO:</strong></h4>
                <blockquote>
                    <p><em>San Lorenzo, io lo so perché tanto<br>
                    di stelle per l'aria tranquilla<br>
                    arde e cade, perché sì gran pianto<br>
                    nel concavo cielo sfavilla.<br><br>

                    Ritornava una rondine al tetto:<br>
                    l'uccisero: cadde tra i spini:<br>
                    era il tempo che il suo rondinotto<br>
                    stillava: pigolio di nini.<br><br>

                    Ora è là, come in croce, che tende<br>
                    quel verme a quel cielo lontano;<br>
                    e il suo nido è nell'ombra, che attende,<br>
                    che pigola sempre più piano.</em></p>
                </blockquote>
            </div>

            <div class="card card-important">
                <h4><strong>ANALISI DETTAGLIATA</strong></h4>
                <h5><strong>PRIMA STROFA: L'ANALOGIA COSMICA</strong></h5>
                <ul>
                    <li><strong>"San Lorenzo":</strong> notte delle stelle cadenti (10 agosto)</li>
                    <li><strong>"io lo so perché":</strong> il poeta rivela il mistero</li>
                    <li><strong>"gran pianto":</strong> le stelle cadenti come lacrime del cielo</li>
                    <li><strong>Analogia:</strong> dolore cosmico per i dolori terreni</li>
                </ul>

                <h5><strong>SECONDA STROFA: LA RONDINE</strong></h5>
                <ul>
                    <li><strong>"Ritornava":</strong> imperfetto durativo, azione abituale interrotta</li>
                    <li><strong>"l'uccisero":</strong> passato remoto, brutalità improvvisa</li>
                    <li><strong>"tra i spini":</strong> particolare realistico e simbolico (corona di spine)</li>
                    <li><strong>"pigolio di nini":</strong> onomatopea, voce dei piccoli</li>
                </ul>
            </div>

            <h3>🦅 GABRIELE D'ANNUNZIO (1863-1938): Il Superuomo Poeta</h3>

            <div class="card card-tip">
                <h4><strong>LA VITA INIMITABILE</strong></h4>
                <ul>
                    <li><strong>1863:</strong> nasce a Pescara da famiglia borghese</li>
                    <li><strong>1879:</strong> "Primo vere", poesie giovanili pubblicate a 16 anni</li>
                    <li><strong>Vita mondana:</strong> amori celebri, lusso, debiti</li>
                    <li><strong>1915:</strong> interventista, partecipa alla Grande Guerra</li>
                    <li><strong>1919:</strong> impresa di Fiume</li>
                </ul>
            </div>

            <h4>La Poetica Dannunziana</h4>

            <div class="card card-important">
                <h4><strong>ESTETISMO</strong></h4>
                <ul>
                    <li><strong>Arte per l'arte:</strong> bellezza come valore supremo</li>
                    <li><strong>Raffinatezza:</strong> ricerca del prezioso, dell'insolito</li>
                    <li><strong>Sensualità:</strong> culto dei sensi, edonismo</li>
                    <li><strong>Decadenza:</strong> fascino per la corruzione elegante</li>
                    <li><strong>Dandy:</strong> figura dell'artista aristocratico</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>SUPEROMISMO</strong></h4>
                <ul>
                    <li><strong>Nietzsche italiano:</strong> interpretazione personale</li>
                    <li><strong>Volontà di potenza:</strong> affermazione dell'io eccezionale</li>
                    <li><strong>Disprezzo della massa:</strong> democrazia come decadenza</li>
                    <li><strong>Esteta-guerriero:</strong> unione di bellezza e forza</li>
                    <li><strong>Mito:</strong> creazione di se stesso come opera d'arte</li>
                </ul>
            </div>

            <h4>📚 Analisi: "La Pioggia nel Pineto" (1902)</h4>

            <div class="card card-highlight">
                <h4><strong>IL TESTO (inizio):</strong></h4>
                <blockquote>
                    <p><em>Taci. Su le soglie<br>
                    del bosco non odo<br>
                    parole che dici<br>
                    umane; ma odo<br>
                    parole più nuove<br>
                    che parlano gocciole e fronde<br>
                    lontane.<br><br>

                    Ascolta. Piove<br>
                    dalle nuvole sparse.<br>
                    Piove su le tamerici<br>
                    salmastre ed arse,<br>
                    piove su i pini<br>
                    scagliosi ed irti,<br>
                    piove su i mirti<br>
                    divini...</em></p>
                </blockquote>
            </div>

            <div class="card card-important">
                <h4><strong>ANALISI STILISTICA</strong></h4>
                <h5><strong>MUSICALITÀ</strong></h5>
                <ul>
                    <li><strong>Versi liberi:</strong> da 3 a 11 sillabe, ritmo vario</li>
                    <li><strong>Anafora "piove":</strong> martellante, ipnotica</li>
                    <li><strong>Allitterazioni:</strong> "gocciole/ginestre"</li>
                    <li><strong>Onomatopee:</strong> il suono imita la pioggia</li>
                </ul>

                <h5><strong>PANISMO</strong></h5>
                <ul>
                    <li><strong>Fusione:</strong> uomo-natura, perdita dell'individualità</li>
                    <li><strong>Metamorfosi:</strong> trasformazione continua</li>
                    <li><strong>Vitalismo:</strong> energia cosmica che attraversa tutto</li>
                </ul>
            </div>

            <h4>🔄 Pascoli vs D'Annunzio: Due Facce del Decadentismo</h4>

            <div class="card card-tip">
                <h4><strong>CONFRONTO SCHEMATICO</strong></h4>
                <p><strong>PASCOLI:</strong> Fanciullino, tono umile, natura-rifugio, linguaggio semplice</p>
                <p><strong>D'ANNUNZIO:</strong> Superuomo, tono aulico, natura-forza, linguaggio prezioso</p>
                <p><strong>COMUNE:</strong> Simbolismo, irrazionalismo, soggettivismo, crisi della modernità</p>
            </div>
        </div>

        <!-- LEZIONE 10: NOVECENTO CON ANCHOR ID -->
        <div id="lezione10" class="lesson-content">
            <h2>🚀 LEZIONE 10: Il Novecento e la Letteratura Contemporanea</h2>

            <div class="card card-tip">
                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                <p><strong>Cosa imparerai:</strong></p>
                <ul>
                    <li>Le Avanguardie storiche e il Futurismo</li>
                    <li>La crisi dell'io: Pirandello e Svevo</li>
                    <li>Le innovazioni narrative del primo Novecento</li>
                    <li>I temi della modernità letteraria</li>
                </ul>
            </div>

            <h3>Le Avanguardie Storiche</h3>
            <div class="card card-highlight">
                <h4><strong>FUTURISMO (1909-1944)</strong></h4>
                <ul>
                    <li><strong>Marinetti:</strong> "Manifesto del Futurismo" (1909)</li>
                    <li><strong>Temi:</strong> velocità, macchina, guerra</li>
                    <li><strong>Tecniche:</strong> parole in libertà, tavole parolibere</li>
                    <li><strong>Influenza:</strong> rottura con la tradizione</li>
                </ul>
            </div>

            <h3>La Crisi dell'Io: Pirandello e Svevo</h3>

            <div class="card card-important">
                <h4><strong>LUIGI PIRANDELLO (1867-1936)</strong></h4>
                <ul>
                    <li><strong>Poetica:</strong> relativismo, crisi dell'identità</li>
                    <li><strong>Teatro:</strong> "Sei personaggi in cerca d'autore"</li>
                    <li><strong>Narrativa:</strong> "Il fu Mattia Pascal"</li>
                    <li><strong>Temi:</strong> maschera vs volto, impossibilità di conoscere</li>
                </ul>
            </div>

            <div class="card card-tip">
                <h4><strong>ITALO SVEVO (1861-1928)</strong></h4>
                <ul>
                    <li><strong>Pseudonimo:</strong> Ettore Schmitz</li>
                    <li><strong>Capolavoro:</strong> "La coscienza di Zeno"</li>
                    <li><strong>Innovazione:</strong> monologo interiore, psicoanalisi</li>
                    <li><strong>Temi:</strong> inettitudine, malattia, tempo misto</li>
                </ul>
            </div>

            <h4>Il Fu Mattia Pascal - Analisi</h4>
            <div class="card card-highlight">
                <h4><strong>LA TRAMA</strong></h4>
                <ul>
                    <li><strong>Mattia Pascal:</strong> uomo che "muore" ufficialmente</li>
                    <li><strong>Adriano Meis:</strong> nuova identità fittizia</li>
                    <li><strong>Crisi d'identità:</strong> non può vivere senza documenti</li>
                    <li><strong>Ritorno:</strong> scopre di essere stato sostituito</li>
                    <li><strong>Finale:</strong> rimane "il fu Mattia Pascal"</li>
                </ul>
            </div>

            <div class="card card-important">
                <h4><strong>I TEMI PIRANDELLIANI</strong></h4>
                <ul>
                    <li><strong>Relativismo:</strong> ogni verità è soggettiva</li>
                    <li><strong>Maschera:</strong> ruoli sociali che imprigionano</li>
                    <li><strong>Umorismo:</strong> "sentimento del contrario"</li>
                    <li><strong>Follia:</strong> unica via di fuga dalla società</li>
                </ul>
            </div><h4>La Coscienza di Zeno - Analisi</h4>
            <div class="card card-tip">
                <h4><strong>STRUTTURA INNOVATIVA</strong></h4>
                <ul>
                    <li><strong>Memorie:</strong> scritte per la psicoanalisi</li>
                    <li><strong>Tempo misto:</strong> passato e presente si confondono</li>
                    <li><strong>Inattendibilità:</strong> del narratore Zeno</li>
                    <li><strong>Malattia:</strong> come condizione esistenziale</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>I TEMI SVEVIANI</strong></h4>
                <ul>
                    <li><strong>Inettitudine:</strong> incapacità di azione nella vita moderna</li>
                    <li><strong>Psicoanalisi:</strong> influenza di Freud</li>
                    <li><strong>Ironia:</strong> autoironia del protagonista</li>
                    <li><strong>Borghesia triestina:</strong> ambiente multiculturale</li>
                </ul>
            </div>

            <h3>Le Innovazioni del Primo Novecento</h3>

            <div class="card card-important">
                <h4><strong>TECNICHE NARRATIVE MODERNE</strong></h4>
                <ul>
                    <li><strong>Flusso di coscienza:</strong> rappresentare i pensieri senza filtro</li>
                    <li><strong>Monologo interiore:</strong> voce della coscienza</li>
                    <li><strong>Tempo psicologico:</strong> non cronologico ma emotivo</li>
                    <li><strong>Narratore inattendibile:</strong> versione soggettiva dei fatti</li>
                </ul>
            </div>

            <h3>I Temi della Modernità Letteraria</h3>

            <div class="card card-tip">
                <h4><strong>LA CRISI DELL'INDIVIDUO MODERNO</strong></h4>
                <ul>
                    <li><strong>Alienazione:</strong> perdita di contatto con la realtà</li>
                    <li><strong>Incomunicabilità:</strong> impossibilità di capirsi</li>
                    <li><strong>Frammentazione:</strong> dell'io e della società</li>
                    <li><strong>Relativismo:</strong> nessuna verità assoluta</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>CONFRONTO: PIRANDELLO VS SVEVO</strong></h4>
                <p><strong>PIRANDELLO:</strong> Teatro, Sicilia, filosofia, maschera sociale</p>
                <p><strong>SVEVO:</strong> Romanzo, Trieste, psicologia, malattia esistenziale</p>
                <p><strong>COMUNE:</strong> Crisi dell'io, inettitudine, ironia, modernità</p>
            </div>

            <h3>Verso la Letteratura Contemporanea</h3>

            <div class="card card-important">
                <h4><strong>EREDITÀ DEL PRIMO NOVECENTO</strong></h4>
                <ul>
                    <li><strong>Sperimentazione:</strong> nuove forme narrative</li>
                    <li><strong>Psicologia:</strong> introspezione profonda</li>
                    <li><strong>Relativismo:</strong> molteplicità di punti di vista</li>
                    <li><strong>Modernità:</strong> temi ancora attuali oggi</li>
                </ul>
            </div>
        </div>

        <!-- METODOLOGIA CON ANCHOR ID -->
        <div id="metodologia" class="lesson-content">
            <h2>📝 MODULO: Metodologia di Analisi del Testo</h2>

            <h3>Tipologie Testuali per l'Esame</h3>

            <div class="card card-important">
                <h4><strong>ANALISI DEL TESTO (Tipologia A)</strong></h4>
                <h5><strong>Struttura consigliata:</strong></h5>
                <ol>
                    <li>Comprensione generale del testo</li>
                    <li>Analisi tematica e contenutistica</li>
                    <li>Analisi stilistica e linguistica</li>
                    <li>Contestualizzazione storico-letteraria</li>
                    <li>Interpretazione critica personale</li>
                </ol>
            </div>

            <div class="card card-tip">
                <h4><strong>SAGGIO BREVE (Tipologia B)</strong></h4>
                <h5><strong>Caratteristiche:</strong></h5>
                <ul>
                    <li>Argomentazione sostenuta da documenti</li>
                    <li>Tesi chiara e coerente</li>
                    <li>Struttura logica: introduzione, sviluppo, conclusione</li>
                    <li>Registro formale e linguaggio specifico</li>
                </ul>
            </div>

            <h3>Figure Retoriche Principali</h3>

            <div class="card card-highlight">
                <h4><strong>FIGURE DI SIGNIFICATO</strong></h4>
                <ul>
                    <li><strong>Metafora:</strong> trasferimento di significato per analogia</li>
                    <li><strong>Metonimia:</strong> sostituzione per contiguità logica</li>
                    <li><strong>Sineddoche:</strong> sostituzione della parte per il tutto</li>
                    <li><strong>Sinestesia:</strong> accostamento di sensazioni diverse</li>
                    <li><strong>Personificazione:</strong> attribuire qualità umane a oggetti</li>
                </ul>

                <h4><strong>FIGURE DI SUONO</strong></h4>
                <ul>
                    <li><strong>Allitterazione:</strong> ripetizione di suoni simili</li>
                    <li><strong>Assonanza:</strong> ripetizione di vocali</li>
                    <li><strong>Consonanza:</strong> ripetizione di consonanti</li>
                    <li><strong>Onomatopea:</strong> imitazione di suoni naturali</li>
                </ul>

                <h4><strong>FIGURE DI POSIZIONE</strong></h4>
                <ul>
                    <li><strong>Chiasmo:</strong> disposizione incrociata di elementi</li>
                    <li><strong>Anafora:</strong> ripetizione a inizio verso/frase</li>
                    <li><strong>Epifora:</strong> ripetizione a fine verso/frase</li>
                    <li><strong>Climax:</strong> gradazione ascendente/discendente</li>
                </ul>
            </div>

            <h3>Metrica Italiana Essenziale</h3>

            <div class="card card-tip">
                <h4><strong>VERSI PRINCIPALI</strong></h4>
                <ul>
                    <li><strong>Endecasillabo (11 sillabe):</strong> verso nobile italiano</li>
                    <li><strong>Settenario (7 sillabe):</strong> verso agile e musicale</li>
                    <li><strong>Ottonario (8 sillabe):</strong> verso narrativo</li>
                    <li><strong>Decasillabo (10 sillabe):</strong> verso epico</li>
                </ul>

                <h4><strong>FORME METRICHE</strong></h4>
                <ul>
                    <li><strong>Sonetto:</strong> 14 versi (2 quartine + 2 terzine)</li>
                    <li><strong>Canzone:</strong> forma metrica complessa</li>
                    <li><strong>Ballata:</strong> forma popolare con ritornello</li>
                    <li><strong>Madrigale:</strong> forma breve e musicale</li>
                </ul>
            </div>

            <h3>Come Affrontare l'Analisi del Testo</h3>

            <div class="card card-important">
                <h4><strong>FASE 1: PRIMA LETTURA</strong></h4>
                <ul>
                    <li>Leggi il testo almeno due volte</li>
                    <li>Individua il tema generale</li>
                    <li>Nota le tue prime impressioni</li>
                    <li>Sottolinea parole chiave</li>
                </ul>
            </div>

            <div class="card card-important">
                <h4><strong>FASE 2: ANALISI DETTAGLIATA</strong></h4>
                <ul>
                    <li>Parafrasi delle parti difficili</li>
                    <li>Individuazione delle figure retoriche</li>
                    <li>Analisi metrica (se poesia)</li>
                    <li>Studio del lessico e del registro</li>
                </ul>
            </div>

            <div class="card card-important">
                <h4><strong>FASE 3: CONTESTUALIZZAZIONE</strong></h4>
                <ul>
                    <li>Colloca l'autore nel suo tempo</li>
                    <li>Individua il movimento letterario</li>
                    <li>Confronta con altre opere</li>
                    <li>Valuta l'originalità del testo</li>
                </ul>
            </div>
        </div>

        <!-- PREPARAZIONE ESAME CON ANCHOR ID -->
        <div id="preparazione" class="lesson-content">
            <h2>✅ PREPARAZIONE ALL'ESAME DI STATO</h2>

            <div class="card card-important">
                <h4><strong>CONSIGLI PER LA PRIMA PROVA</strong></h4>
                <ul>
                    <li><strong>Pianifica sempre:</strong> schema mentale prima di scrivere</li>
                    <li><strong>Gestisci il tempo:</strong> 1 ora per scegliere e pianificare, 4 per scrivere, 1 per rivedere</li>
                    <li><strong>Varia la sintassi:</strong> alterna frasi brevi e lunghe</li>
                    <li><strong>Usa connettivi logici:</strong> infatti, inoltre, tuttavia, dunque</li>
                    <li><strong>Rileggi sempre:</strong> correggere errori e imprecisioni</li>
                    <li><strong>Cita correttamente:</strong> virgolette per le citazioni dirette</li>
                </ul>
            </div>

            <div class="card card-tip">
                <h4><strong>AUTORI E OPERE ESSENZIALI DA RICORDARE</strong></h4>
                <ul>
                    <li><strong>Dante:</strong> Divina Commedia (Inferno, canti principali)</li>
                    <li><strong>Petrarca:</strong> Canzoniere (sonetti sull'amore per Laura)</li>
                    <li><strong>Boccaccio:</strong> Decameron (struttura e temi)</li>
                    <li><strong>Machiavelli:</strong> Il Principe (realismo politico)</li>
                    <li><strong>Ariosto:</strong> Orlando Furioso (ironia cavalleresca)</li>
                    <li><strong>Goldoni:</strong> La Locandiera (riforma teatrale)</li>
                    <li><strong>Foscolo:</strong> Ultime lettere di Jacopo Ortis, sonetti</li>
                    <li><strong>Manzoni:</strong> I Promessi Sposi (romanzo storico)</li>
                    <li><strong>Leopardi:</strong> Canti (pessimismo e infinito)</li>
                    <li><strong>Verga:</strong> I Malavoglia (verismo)</li>
                    <li><strong>Pascoli:</strong> Myricae (simbolismo e fanciullino)</li>
                    <li><strong>D'Annunzio:</strong> Alcyone (estetismo e panismo)</li>
                    <li><strong>Pirandello:</strong> Il fu Mattia Pascal (crisi dell'identità)</li>
                    <li><strong>Svevo:</strong> La coscienza di Zeno (psicoanalisi)</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>SCHEMA DI RIPASSO FINALE</strong></h4>
                <p><strong>SETTIMANA 1:</strong> Medioevo (Dante, Petrarca, Boccaccio)</p>
                <p><strong>SETTIMANA 2:</strong> Rinascimento (Machiavelli, Ariosto)</p>
                <p><strong>SETTIMANA 3:</strong> Settecento (Goldoni, Parini, Alfieri)</p>
                <p><strong>SETTIMANA 4:</strong> Romanticismo (Foscolo, Manzoni, Leopardi)</p>
                <p><strong>SETTIMANA 5:</strong> Realismo e Verismo (Verga)</p>
                <p><strong>SETTIMANA 6:</strong> Decadentismo (Pascoli, D'Annunzio)</p>
                <p><strong>SETTIMANA 7:</strong> Novecento (Pirandello, Svevo, Futurismo)</p>
                <p><strong>SETTIMANA 8:</strong> Ripasso generale e simulazioni d'esame</p>
            </div>

            <div class="card card-important">
                <h4><strong>TECNICHE DI MEMORIZZAZIONE</strong></h4>
                <ul>
                    <li><strong>Mappe concettuali:</strong> collega autori, opere, temi</li>
                    <li><strong>Timeline:</strong> linea temporale degli autori</li>
                    <li><strong>Schemi comparativi:</strong> confronta autori simili</li>
                    <li><strong>Citazioni chiave:</strong> impara a memoria i versi più famosi</li>
                    <li><strong>Esempi pratici:</strong> associa ogni concetto a un esempio</li>
                </ul>
            </div>

            <div class="card card-tip">
                <h4><strong>ERRORI DA EVITARE</strong></h4>
                <ul>
                    <li><strong>Non confondere:</strong> periodi storici e movimenti letterari</li>
                    <li><strong>Non generalizzare:</strong> ogni autore ha le sue specificità</li>
                    <li><strong>Non essere banale:</strong> evita frasi fatte e luoghi comuni</li>
                    <li><strong>Non andare fuori tema:</strong> rispondi sempre alla domanda</li>
                    <li><strong>Non citare a memoria:</strong> senza capire il significato</li>
                </ul>
            </div>

            <h3>Simulazioni e Esercizi Pratici</h3>

            <div class="card card-highlight">
                <h4><strong>ESERCIZIO 1: ANALISI DEL TESTO</strong></h4>
                <p><strong>Prova con:</strong> "Nel mezzo del cammin di nostra vita" (Dante)</p>
                <ul>
                    <li>Parafrasi del testo</li>
                    <li>Individuazione delle figure retoriche</li>
                    <li>Significato simbolico</li>
                    <li>Contestualizzazione nell'opera</li>
                </ul>
            </div>

            <div class="card card-highlight">
                <h4><strong>ESERCIZIO 2: CONFRONTO TRA AUTORI</strong></h4>
                <p><strong>Confronta:</strong> Leopardi e Foscolo sul tema dell'esilio</p>
                <ul>
                    <li>Punti in comune</li>
                    <li>Differenze di approccio</li>
                    <li>Contesto storico</li>
                    <li>Soluzioni poetiche</li>
                </ul>
            </div>

            <div class="card card-important">
                <h4><strong>CHECKLIST FINALE PRIMA DELL'ESAME</strong></h4>
                <ul>
                    <li>✅ Conosco i periodi letterari e le loro caratteristiche</li>
                    <li>✅ So collegare autori, opere e contesto storico</li>
                    <li>✅ Riconosco le principali figure retoriche</li>
                    <li>✅ So fare la parafrasi di un testo poetico</li>
                    <li>✅ Conosco le tecniche narrative dei principali autori</li>
                    <li>✅ So scrivere un'analisi del testo strutturata</li>
                    <li>✅ Ho fatto simulazioni pratiche</li>
                    <li>✅ Sono pronto per l'esame!</li>
                </ul>
            </div>

            <div class="card card-tip">
                <h4><strong>ULTIMO CONSIGLIO</strong></h4>
                <p>La letteratura italiana è un patrimonio straordinario che racconta la storia del nostro pensiero e della nostra cultura. Non studiarla solo per l'esame, ma per capire chi siamo e da dove veniamo. <strong>In bocca al lupo!</strong></p>
            </div>
        </div>

    </div>
</section>

                <!-- Sezione Storia -->
                <section id="storia" class="section">
                    <div class="lesson-content">
                        <h2>🏛️ STORIA - Programma Completo per l'Esame</h2>

                        <div id="storia-lezione1" class="lesson-content">
                            <h2>🏛️ LEZIONE 1: L'Alto Medioevo</h2>

                            <div class="card card-tip">
                                <h3 class="card-title">🎯 Obiettivi della lezione</h3>
                                <ul>
                                    <li>Il crollo dell'Impero Romano d'Occidente</li>
                                    <li>Le invasioni barbariche e i regni romano-barbarici</li>
                                    <li>L'ascesa del Cristianesimo e del Papato</li>
                                    <li>L'Impero Carolingio e Carlo Magno</li>
                                </ul>
                            </div>

                            <h3>🏛️ LA FINE DELL'IMPERO ROMANO D'OCCIDENTE (476 d.C.)</h3>

                            <div class="card card-important">
                                <h3 class="card-title">LE CAUSE DELLA CRISI</h3>
                                <h4>CRISI ECONOMICA</h4>
                                <ul>
                                    <li><strong>Inflazione:</strong> svalutazione della moneta</li>
                                    <li><strong>Crisi agricola:</strong> abbandono delle campagne</li>
                                    <li><strong>Crisi commerciale:</strong> insicurezza delle strade</li>
                                    <li><strong>Tasse:</strong> sempre più pesanti per mantenere l'esercito</li>
                                </ul>
                            </div>
                        </div>

                        <div id="storia-lezione2" class="lesson-content">
                            <h2>🌱 LEZIONE 2: Il Basso Medioevo</h2>
                            <div class="card card-highlight">
                                <h4><strong>LA RINASCITA DELL'ANNO MILLE</strong></h4>
                                <p>Crescita demografica, innovazioni agricole, rinascita delle città.</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Sezione Psicologia -->
                <section id="psicologia" class="section">
                    <div class="lesson-header">
                        <h1 class="lesson-title">🧠 Psicologia</h1>
                        <p class="lesson-subtitle">Scienza del comportamento e dei processi mentali</p>
                    </div>

                    <div class="card card-tip">
                        <h3 class="card-title">🎯 Cos'è la Psicologia?</h3>
                        <p>La psicologia è la scienza che studia il comportamento umano e i processi mentali. Si occupa di comprendere come pensiamo, sentiamo, apprendiamo e ci relazioniamo con gli altri.</p>
                    </div>
                </section>

                <!-- Altre sezioni... -->
                <section id="matematica" class="section">
                    <div class="lesson-header">
                        <h1 class="lesson-title">🔢 Matematica</h1>
                        <p class="lesson-subtitle">Fondamenti matematici per l'esame</p>
                    </div>
                </section>

                <section id="inglese" class="section">
                    <div class="lesson-header">
                        <h1 class="lesson-title">🇬🇧 Inglese</h1>
                        <p class="lesson-subtitle">English for academic purposes</p>
                    </div>
                </section>

                <section id="pedagogia" class="section">
                    <div class="lesson-header">
                        <h1 class="lesson-title">👥 Pedagogia</h1>
                        <p class="lesson-subtitle">Scienze dell'educazione e della formazione</p>
                    </div>
                </section>

                <section id="sociologia" class="section">
                    <div class="lesson-header">
                        <h1 class="lesson-title">🌍 Sociologia</h1>
                        <p class="lesson-subtitle">Studio della società e dei fenomeni sociali</p>
                    </div>
                </section>

                <section id="filosofia" class="section">
                    <div class="lesson-header">
                        <h1 class="lesson-title">💭 Filosofia</h1>
                        <p class="lesson-subtitle">Storia del pensiero occidentale</p>
                    </div>
                </section>
            </div>
        </div>
    </main>

    <!-- Floating Controls -->
    <div class="floating-controls">
        <!-- Enhanced Audio Player -->
        <div class="audio-player" id="audioPlayer">
            <div class="audio-header">
                <span class="audio-title">🎧 Lettura Audio</span>
                <button class="close-audio" id="closeAudio">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="current-reading-info" id="currentReadingInfo">
                <i class="fas fa-book-open"></i>
                <span id="currentReadingText">Seleziona un contenuto per iniziare</span>
            </div>

            <div class="audio-controls">
                <div class="main-audio-controls">
                    <button class="nav-btn" id="prevBtn" title="Precedente">
                        <i class="fas fa-step-backward"></i>
                    </button>

                    <button class="play-btn" id="playBtn">
                        <i class="fas fa-play"></i>
                    </button>

                    <button class="nav-btn" id="nextBtn" title="Successivo">
                        <i class="fas fa-step-forward"></i>
                    </button>
                </div>
            </div>

            <div class="secondary-controls">
                <button class="control-btn" id="pauseBtn" title="Pausa">
                    <i class="fas fa-pause"></i>
                </button>
                <button class="control-btn" id="stopBtn" title="Stop">
                    <i class="fas fa-stop"></i>
                </button>
                <button class="control-btn" id="speedBtn" title="Velocità">1x</button>
                <button class="control-btn" id="repeatBtn" title="Ripeti">
                    <i class="fas fa-redo"></i>
                </button>
            </div>

            <div class="speed-indicator">
                Usa i pulsanti per navigare tra le lezioni
            </div>
        </div>

        <!-- FAB Menu -->
        <div class="fab-container">
            <div class="fab-menu" id="fabMenu">
                <button class="fab-item" id="pomodoroBtn" title="Timer Pomodoro">
                    <i class="fas fa-clock"></i>
                </button>
                <button class="fab-item" id="statsBtn" title="Statistiche">
                    <i class="fas fa-chart-bar"></i>
                </button>
                <button class="fab-item" id="exportBtn" title="Esporta Note">
                    <i class="fas fa-download"></i>
                </button>
                <button class="fab-item" id="audioToggleBtn" title="Lettura Audio">
                    <i class="fas fa-volume-up"></i>
                </button>
            </div>

            <button class="fab-main" id="fabMain">
                <i class="fas fa-plus"></i>
            </button>
        </div>
    </div>

    <!-- Status Notification -->
    <div class="status-notification" id="statusNotification">
        <div id="statusMessage"></div>
    </div>

    <script>
        // Enhanced StudyHub Manager con lettura intelligente e navigazione
        class EnhancedStudyHubManager {
            constructor() {
                this.currentSection = 'index';
                this.currentAnchor = null;
                this.sections = ['index', 'italiano', 'storia', 'matematica', 'inglese', 'psicologia', 'pedagogia', 'sociologia', 'filosofia'];

                // Audio system
                this.speechSynthesis = window.speechSynthesis;
                this.currentUtterance = null;
                this.isReading = false;
                this.readingSpeed = 1;
                this.speedOptions = [0.5, 0.75, 1, 1.25, 1.5, 2];
                this.currentReadingIndex = 0;
                this.readableElements = [];
                this.isRepeatMode = false;

                // UI state
                this.isDarkTheme = false;
                this.isAudioPlayerVisible = false;
                this.isFabMenuOpen = false;
                this.pomodoroTimer = null;

                this.init();
            }

            init() {
                this.setupEventListeners();
                this.setupKeyboardShortcuts();
                this.setupTouchGestures();
                this.generateTOC();
                this.loadUserPreferences();
                this.updateProgressBar();
                this.showWelcomeNotification();
                this.initializeReadableElements();
            }

            setupEventListeners() {
                // Navigation buttons
                document.querySelectorAll('.subject-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const section = e.currentTarget.getAttribute('data-section');
                        this.showSection(section);
                    });
                });

                // Lesson links
                document.querySelectorAll('.lesson-link').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = e.currentTarget.getAttribute('data-section');
                        const anchor = e.currentTarget.getAttribute('data-anchor');
                        this.showSection(section, anchor);
                    });
                });

                // Header actions
                document.getElementById('themeBtn').addEventListener('click', () => this.toggleTheme());
                document.getElementById('fullscreenBtn').addEventListener('click', () => this.toggleFullscreen());
                document.getElementById('bookmarkBtn').addEventListener('click', () => this.addBookmark());
                document.getElementById('searchBtn').addEventListener('click', () => this.showSearch());
                document.getElementById('menuBtn').addEventListener('click', () => this.toggleMobileMenu());

                // Enhanced audio controls
                document.getElementById('playBtn').addEventListener('click', () => this.startReading());
                document.getElementById('pauseBtn').addEventListener('click', () => this.pauseReading());
                document.getElementById('stopBtn').addEventListener('click', () => this.stopReading());
                document.getElementById('speedBtn').addEventListener('click', () => this.adjustSpeed());
                document.getElementById('prevBtn').addEventListener('click', () => this.previousElement());
                document.getElementById('nextBtn').addEventListener('click', () => this.nextElement());
                document.getElementById('repeatBtn').addEventListener('click', () => this.toggleRepeatMode());
                document.getElementById('closeAudio').addEventListener('click', () => this.hideAudioPlayer());

                // FAB controls
                document.getElementById('fabMain').addEventListener('click', () => this.toggleFabMenu());
                document.getElementById('audioToggleBtn').addEventListener('click', () => this.toggleAudioPlayer());
                document.getElementById('pomodoroBtn').addEventListener('click', () => this.startPomodoro());
                document.getElementById('statsBtn').addEventListener('click', () => this.showStats());
                document.getElementById('exportBtn').addEventListener('click', () => this.exportNotes());

                // TOC clicks
                document.addEventListener('click', (e) => {
                    if (e.target.classList.contains('toc-item')) {
                        e.preventDefault();
                        const section = e.target.getAttribute('data-section');
                        const anchor = e.target.getAttribute('data-anchor');
                        this.showSection(section, anchor);
                    }
                });
            }

            setupKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    // Ctrl + Space: Toggle reading
                    if (e.ctrlKey && e.code === 'Space') {
                        e.preventDefault();
                        this.isReading ? this.pauseReading() : this.startReading();
                    }

                    // Arrow keys for navigation during reading
                    if (this.isReading) {
                        if (e.key === 'ArrowRight') {
                            e.preventDefault();
                            this.nextElement();
                        }
                        if (e.key === 'ArrowLeft') {
                            e.preventDefault();
                            this.previousElement();
                        }
                    }

                    // Ctrl + B: Add bookmark
                    if (e.ctrlKey && e.key === 'b') {
                        e.preventDefault();
                        this.addBookmark();
                    }

                    // Ctrl + T: Toggle theme
                    if (e.ctrlKey && e.key === 't') {
                        e.preventDefault();
                        this.toggleTheme();
                    }

                    // Escape: Stop reading and close menus
                    if (e.key === 'Escape') {
                        this.stopReading();
                        this.closeFabMenu();
                        this.hideAudioPlayer();
                    }
                });
            }

            setupTouchGestures() {
                let touchStartX = 0;
                let touchEndX = 0;

                document.addEventListener('touchstart', (e) => {
                    touchStartX = e.changedTouches[0].screenX;
                });

                document.addEventListener('touchend', (e) => {
                    touchEndX = e.changedTouches[0].screenX;
                    this.handleSwipeGesture(touchStartX, touchEndX);
                });
            }

            handleSwipeGesture(startX, endX) {
                const threshold = 100;
                const diff = startX - endX;

                if (Math.abs(diff) > threshold) {
                    if (this.isReading) {
                        if (diff > 0) {
                            this.nextElement(); // Swipe left - next
                        } else {
                            this.previousElement();// Swipe right - previous
                        }
                    } else {
                        const currentIndex = this.sections.indexOf(this.currentSection);
                        if (diff > 0 && currentIndex < this.sections.length - 1) {
                            this.showSection(this.sections[currentIndex + 1]);
                        } else if (diff < 0 && currentIndex > 0) {
                            this.showSection(this.sections[currentIndex - 1]);
                        }
                    }
                }
            }

            showSection(sectionId, anchorId = null) {
                // Hide all sections
                document.querySelectorAll('.section').forEach(section => {
                    section.classList.remove('active');
                });

                // Show target section
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.add('active');
                    this.currentSection = sectionId;
                    this.currentAnchor = anchorId;
                }

                // Update navigation
                document.querySelectorAll('.subject-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.getAttribute('data-section') === sectionId) {
                        btn.classList.add('active');
                    }
                });

                // Handle anchor scrolling and setup reading
                if (anchorId) {
                    setTimeout(() => {
                        const anchorElement = document.getElementById(anchorId);
                        if (anchorElement) {
                            anchorElement.scrollIntoView({
                                behavior: 'smooth',
                                block: 'start'
                            });
                            this.highlightElement(anchorElement);
                            // Set up reading from this specific anchor
                            this.initializeReadableElements(anchorElement);
                        }
                    }, 300);
                } else {
                    // Initialize readable elements for the entire section
                    this.initializeReadableElements();
                }

                this.updateProgressBar();
                this.updateTOC();
                this.updateCurrentReadingInfo();
                this.saveProgress(sectionId, anchorId);
            }

            initializeReadableElements(startElement = null) {
                const activeSection = document.querySelector('.section.active');
                if (!activeSection) return;

                let elementsToRead = [];

                if (startElement) {
                    // Start from specific anchor
                    const allElements = Array.from(activeSection.querySelectorAll('h2, h3, p, li, blockquote, .card-title'));
                    const startIndex = allElements.findIndex(el =>
                        startElement.contains(el) || el.contains(startElement) || el === startElement
                    );
                    elementsToRead = allElements.slice(startIndex >= 0 ? startIndex : 0);
                } else {
                    // Read entire section
                    elementsToRead = Array.from(activeSection.querySelectorAll('h2, h3, p, li, blockquote, .card-title'));
                }

                this.readableElements = elementsToRead.filter(el => {
                    const text = el.textContent.trim();
                    return text.length > 0 && !text.match(/^[📚📖👤🌹🏛️🎭🌅🌙🌸🚀⚙️📅🔢🇬🇧🧠👥🌍💭✅❌⚡🔥💡]+$/);
                });

                this.currentReadingIndex = 0;
                this.updateNavigationButtons();
                this.updateCurrentReadingInfo();
            }

            startReading() {
                if (!this.speechSynthesis) {
                    this.showNotification('❌ Sintesi vocale non supportata su questo dispositivo', 'error');
                    return;
                }

                if (this.readableElements.length === 0) {
                    this.initializeReadableElements();
                    if (this.readableElements.length === 0) {
                        this.showNotification('⚠️ Nessun contenuto da leggere', 'warning');
                        return;
                    }
                }

                // Stop any current reading
                this.speechSynthesis.cancel();

                const currentElement = this.readableElements[this.currentReadingIndex];
                if (!currentElement) {
                    this.showNotification('⚠️ Nessun elemento da leggere', 'warning');
                    return;
                }

                const textContent = this.extractTextContent(currentElement);
                if (!textContent.trim()) {
                    this.nextElement();
                    return;
                }

                // Highlight current element
                this.highlightCurrentReading(currentElement);

                this.currentUtterance = new SpeechSynthesisUtterance(textContent);
                this.currentUtterance.lang = 'it-IT';
                this.currentUtterance.rate = this.readingSpeed;
                this.currentUtterance.pitch = 1;
                this.currentUtterance.volume = 0.8;

                this.currentUtterance.onstart = () => {
                    this.isReading = true;
                    this.updateAudioButtons();
                    this.showAudioPlayer();
                    this.showNotification('🔊 Lettura in corso...', 'success');
                };

                this.currentUtterance.onend = () => {
                    this.isReading = false;
                    this.updateAudioButtons();

                    if (this.isRepeatMode) {
                        // Repeat current element
                        setTimeout(() => this.startReading(), 500);
                    } else if (this.currentReadingIndex < this.readableElements.length - 1) {
                        // Auto-advance to next element
                        setTimeout(() => {
                            this.nextElement();
                            this.startReading();
                        }, 1000);
                    } else {
                        this.showNotification('✅ Lettura completata', 'success');
                        this.clearCurrentHighlight();
                    }
                };

                this.currentUtterance.onerror = (event) => {
                    console.error('Speech synthesis error:', event);
                    this.isReading = false;
                    this.updateAudioButtons();
                    this.showNotification('❌ Errore durante la lettura', 'error');
                };

                this.speechSynthesis.speak(this.currentUtterance);
                this.updateCurrentReadingInfo();
            }

            pauseReading() {
                if (!this.speechSynthesis.speaking) {
                    this.showNotification('⚠️ Nessuna lettura in corso', 'warning');
                    return;
                }

                if (this.speechSynthesis.paused) {
                    this.speechSynthesis.resume();
                    this.isReading = true;
                    this.showNotification('▶️ Lettura ripresa', 'success');
                } else {
                    this.speechSynthesis.pause();
                    this.isReading = false;
                    this.showNotification('⏸️ Lettura in pausa', 'success');
                }
                this.updateAudioButtons();
            }

            stopReading() {
                this.speechSynthesis.cancel();
                this.isReading = false;
                this.currentUtterance = null;
                this.clearCurrentHighlight();
                this.updateAudioButtons();
                this.showNotification('⏹️ Lettura fermata', 'success');
            }

            nextElement() {
                if (this.currentReadingIndex < this.readableElements.length - 1) {
                    this.currentReadingIndex++;
                    this.updateNavigationButtons();
                    this.updateCurrentReadingInfo();

                    if (this.isReading) {
                        this.speechSynthesis.cancel();
                        setTimeout(() => this.startReading(), 100);
                    } else {
                        this.highlightCurrentReading(this.readableElements[this.currentReadingIndex]);
                    }
                } else {
                    this.showNotification('📖 Ultimo elemento raggiunto', 'warning');
                }
            }

            previousElement() {
                if (this.currentReadingIndex > 0) {
                    this.currentReadingIndex--;
                    this.updateNavigationButtons();
                    this.updateCurrentReadingInfo();

                    if (this.isReading) {
                        this.speechSynthesis.cancel();
                        setTimeout(() => this.startReading(), 100);
                    } else {
                        this.highlightCurrentReading(this.readableElements[this.currentReadingIndex]);
                    }
                } else {
                    this.showNotification('📖 Primo elemento raggiunto', 'warning');
                }
            }

            toggleRepeatMode() {
                this.isRepeatMode = !this.isRepeatMode;
                const repeatBtn = document.getElementById('repeatBtn');
                const icon = repeatBtn.querySelector('i');

                if (this.isRepeatMode) {
                    repeatBtn.style.background = 'var(--accent-color)';
                    repeatBtn.style.color = 'white';
                    icon.className = 'fas fa-redo pulse';
                    this.showNotification('🔄 Modalità ripetizione attivata', 'success');
                } else {
                    repeatBtn.style.background = 'var(--bg-secondary)';
                    repeatBtn.style.color = 'var(--text-secondary)';
                    icon.className = 'fas fa-redo';
                    this.showNotification('🔄 Modalità ripetizione disattivata', 'success');
                }
            }

            highlightCurrentReading(element) {
                this.clearCurrentHighlight();
                if (element) {
                    element.classList.add('current-reading');
                    element.scrollIntoView({ behavior: 'smooth', block: 'center' });

                    // Update TOC
                    this.updateTOCHighlight(element);
                }
            }

            clearCurrentHighlight() {
                document.querySelectorAll('.current-reading').forEach(el => {
                    el.classList.remove('current-reading');
                });

                document.querySelectorAll('.toc-item.current-reading').forEach(el => {
                    el.classList.remove('current-reading');
                });
            }

            updateTOCHighlight(element) {
                // Find corresponding TOC item
                const headingId = element.id || element.closest('[id]')?.id;
                if (headingId) {
                    document.querySelectorAll('.toc-item').forEach(item => {
                        item.classList.remove('current-reading');
                        if (item.getAttribute('data-anchor') === headingId) {
                            item.classList.add('current-reading');
                        }
                    });
                }
            }

            updateNavigationButtons() {
                const prevBtn = document.getElementById('prevBtn');
                const nextBtn = document.getElementById('nextBtn');

                prevBtn.disabled = this.currentReadingIndex === 0;
                nextBtn.disabled = this.currentReadingIndex >= this.readableElements.length - 1;
            }

            updateCurrentReadingInfo() {
                const infoElement = document.getElementById('currentReadingText');
                if (this.readableElements.length > 0 && this.currentReadingIndex < this.readableElements.length) {
                    const currentElement = this.readableElements[this.currentReadingIndex];
                    const text = currentElement.textContent.trim();
                    const preview = text.length > 50 ? text.substring(0, 50) + '...' : text;
                    infoElement.textContent = `${this.currentReadingIndex + 1}/${this.readableElements.length}: ${preview}`;
                } else {
                    infoElement.textContent = 'Seleziona un contenuto per iniziare';
                }
            }

            adjustSpeed() {
                const currentIndex = this.speedOptions.indexOf(this.readingSpeed);
                const nextIndex = (currentIndex + 1) % this.speedOptions.length;
                this.readingSpeed = this.speedOptions[nextIndex];

                const speedBtn = document.getElementById('speedBtn');
                speedBtn.textContent = `${this.readingSpeed}x`;

                this.showNotification(`🎚️ Velocità: ${this.readingSpeed}x`, 'success');

                if (this.isReading) {
                    this.stopReading();
                    setTimeout(() => this.startReading(), 100);
                }
            }

            updateAudioButtons() {
                const playBtn = document.getElementById('playBtn');
                const playIcon = playBtn.querySelector('i');

                if (this.isReading) {
                    playIcon.className = 'fas fa-volume-up pulse';
                    playBtn.classList.add('reading');
                } else {
                    playIcon.className = 'fas fa-play';
                    playBtn.classList.remove('reading');
                }
            }

            extractTextContent(element) {
                let text = element.textContent || element.innerText;

                // Clean up the text
                text = text
                    .replace(/[📚📖👤🌹🏛️🎭🌅🌙🌸🚀⚙️📅🔢🇬🇧🧠👥🌍💭✅❌⚡🔥💡🎯🎨💀🌱🏰🎖️👑🌸🔮🔄]/g, '')
                    .replace(/•/g, '')
                    .replace(/\s+/g, ' ')
                    .replace(/\n+/g, '. ')
                    .replace(/\.\s*\./g, '.')
                    .trim();

                // Add pauses for better speech
                text = text.replace(/:/g, ', ');
                text = text.replace(/;/g, ', ');
                text = text.replace(/\./g, '. ');

                return text;
            }

            highlightElement(element) {
                element.style.transition = 'all 0.5s ease';
                element.style.backgroundColor = 'var(--primary-color)';
                element.style.color = 'white';
                element.style.borderRadius = 'var(--border-radius-lg)';
                element.style.padding = '1rem';

                setTimeout(() => {
                    element.style.backgroundColor = '';
                    element.style.color = '';
                    element.style.padding = '';
                }, 2000);
            }

            generateTOC() {
                const tocContainer = document.getElementById('tocContainer');
                const currentSectionElement = document.getElementById(this.currentSection);

                if (!currentSectionElement) return;

                const headings = currentSectionElement.querySelectorAll('h2, h3[id], div[id]');
                tocContainer.innerHTML = '';

                headings.forEach(heading => {
                    const tocItem = document.createElement('a');
                    tocItem.href = '#';
                    tocItem.className = 'toc-item';
                    tocItem.setAttribute('data-section', this.currentSection);

                    if (heading.id) {
                        tocItem.setAttribute('data-anchor', heading.id);
                    }

                    tocItem.textContent = heading.textContent;
                    tocContainer.appendChild(tocItem);
                });
            }

            updateTOC() {
                this.generateTOC();
            }

            toggleTheme() {
                this.isDarkTheme = !this.isDarkTheme;
                document.body.classList.toggle('dark-theme', this.isDarkTheme);

                const themeIcon = document.querySelector('#themeBtn i');
                themeIcon.className = this.isDarkTheme ? 'fas fa-sun' : 'fas fa-moon';

                this.showNotification(
                    this.isDarkTheme ? '🌙 Tema scuro attivato' : '☀️ Tema chiaro attivato',
                    'success'
                );

                this.saveUserPreferences();
            }

            toggleFullscreen() {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().then(() => {
                        this.showNotification('🔲 Modalità schermo intero', 'success');
                        document.querySelector('#fullscreenBtn i').className = 'fas fa-compress';
                    }).catch(() => {
                        this.showNotification('❌ Fullscreen non supportato', 'error');
                    });
                } else {
                    document.exitFullscreen().then(() => {
                        this.showNotification('🪟 Modalità normale', 'success');
                        document.querySelector('#fullscreenBtn i').className = 'fas fa-expand';
                    });
                }
            }

            toggleAudioPlayer() {
                this.isAudioPlayerVisible = !this.isAudioPlayerVisible;
                const audioPlayer = document.getElementById('audioPlayer');

                if (this.isAudioPlayerVisible) {
                    audioPlayer.classList.add('visible');
                    this.showNotification('🎧 Player audio aperto', 'success');
                } else {
                    audioPlayer.classList.remove('visible');
                    this.showNotification('🎧 Player audio chiuso', 'success');
                }
            }

            showAudioPlayer() {
                this.isAudioPlayerVisible = true;
                document.getElementById('audioPlayer').classList.add('visible');
            }

            hideAudioPlayer() {
                this.isAudioPlayerVisible = false;
                document.getElementById('audioPlayer').classList.remove('visible');
                this.stopReading();
            }

            toggleFabMenu() {
                this.isFabMenuOpen = !this.isFabMenuOpen;
                const fabMenu = document.getElementById('fabMenu');
                const fabMain = document.getElementById('fabMain');

                fabMenu.classList.toggle('open', this.isFabMenuOpen);
                fabMain.style.transform = this.isFabMenuOpen ? 'rotate(45deg)' : 'rotate(0deg)';
            }

            closeFabMenu() {
                this.isFabMenuOpen = false;
                document.getElementById('fabMenu').classList.remove('open');
                document.getElementById('fabMain').style.transform = 'rotate(0deg)';
            }

            addBookmark() {
                const bookmarks = this.getBookmarks();
                const bookmark = {
                    id: Date.now(),
                    section: this.currentSection,
                    anchor: this.currentAnchor,
                    title: this.getCurrentSectionTitle(),
                    readingIndex: this.currentReadingIndex,
                    timestamp: new Date().toISOString()
                };

                bookmarks.push(bookmark);
                localStorage.setItem('studyhub_bookmarks', JSON.stringify(bookmarks));
                this.showNotification('🔖 Bookmark aggiunto!', 'success');
            }

            getBookmarks() {
                return JSON.parse(localStorage.getItem('studyhub_bookmarks') || '[]');
            }

            getCurrentSectionTitle() {
                const activeSection = document.querySelector('.section.active .lesson-title');
                return activeSection ? activeSection.textContent : this.currentSection;
            }

            startPomodoro() {
                const minutes = prompt('🍅 Timer Pomodoro\n\nInserisci i minuti (default: 25):', '25');
                if (minutes && !isNaN(minutes) && minutes > 0) {
                    this.startPomodoroTimer(parseInt(minutes));
                }
            }

            startPomodoroTimer(minutes) {
                if (this.pomodoroTimer) {
                    clearInterval(this.pomodoroTimer);
                }

                let timeLeft = minutes * 60;
                this.showNotification(`🍅 Timer Pomodoro: ${minutes} minuti iniziati`, 'success');

                let timerDisplay = document.getElementById('pomodoro-timer');
                if (!timerDisplay) {
                    timerDisplay = document.createElement('div');
                    timerDisplay.id = 'pomodoro-timer';
                    timerDisplay.style.cssText = `
                        position: fixed;
                        top: calc(var(--total-header-height) + 1rem);
                        left: 2rem;
                        background: var(--error-color);
                        color: white;
                        padding: 1rem 1.5rem;
                        border-radius: var(--border-radius-xl);
                        font-weight: 600;
                        z-index: 1003;
                        box-shadow: var(--shadow-xl);
                        cursor: pointer;
                        transition: all 0.3s ease;
                        border: 2px solid white;
                        font-family: 'Courier New', monospace;
                    `;
                    document.body.appendChild(timerDisplay);
                }

                this.pomodoroTimer = setInterval(() => {
                    const minutesLeft = Math.floor(timeLeft / 60);
                    const secondsLeft = timeLeft % 60;

                    timerDisplay.textContent = `🍅 ${minutesLeft}:${secondsLeft.toString().padStart(2, '0')}`;

                    if (timeLeft <= 0) {
                        clearInterval(this.pomodoroTimer);
                        timerDisplay.remove();
                        this.showNotification('⏰ Tempo Pomodoro terminato! Pausa di 5 minuti', 'warning');

                        if ('Notification' in window && Notification.permission === 'granted') {
                            new Notification('🍅 Pomodoro terminato!', {
                                body: 'Tempo di fare una pausa di 5 minuti',
                                icon: '/favicon.ico'
                            });
                        }
                    }

                    timeLeft--;
                }, 1000);

                timerDisplay.addEventListener('click', () => {
                    if (confirm('Vuoi fermare il timer Pomodoro?')) {
                        clearInterval(this.pomodoroTimer);
                        timerDisplay.remove();
                        this.showNotification('⏹️ Timer Pomodoro fermato', 'success');
                    }
                });
            }

            showStats() {
                const progress = this.getProgress();
                const bookmarks = this.getBookmarks();
                const stats = this.calculateStats(progress, bookmarks);

                const message = `📊 Le tue Statistiche di Studio:

📚 Sezioni completate: ${stats.sectionsCompleted}
🔖 Bookmark creati: ${stats.bookmarksCreated}
🔥 Giorni di studio consecutivi: ${stats.studyStreak}
⭐ Sezione preferita: ${stats.favoriteSection}
📅 Ultima sessione: ${stats.lastStudySession}
🎧 Tempo di ascolto: ${stats.listeningTime}

${stats.studyStreak > 0 ? '🎉 Ottimo lavoro! Continua così!' : '💪 Inizia oggi la tua serie di studio!'}`;

                alert(message);
            }

            calculateStats(progress, bookmarks) {
                return {
                    sectionsCompleted: Object.keys(progress).length,
                    bookmarksCreated: bookmarks.length,
                    studyStreak: this.calculateStudyStreak(progress),
                    favoriteSection: this.getFavoriteSection(progress),
                    lastStudySession: this.getLastStudyDate(progress),
                    listeningTime: this.getListeningTime()
                };
            }

            calculateStudyStreak(progress) {
                const dates = Object.values(progress)
                    .map(p => new Date(p.timestamp).toDateString())
                    .filter((date, index, array) => array.indexOf(date) === index)
                    .sort((a, b) => new Date(b) - new Date(a));

                let streak = 0;
                for (let i = 0; i < dates.length; i++) {
                    const currentDate = new Date(dates[i]);
                    const expectedDate = new Date();
                    expectedDate.setDate(expectedDate.getDate() - i);

                    if (currentDate.toDateString() === expectedDate.toDateString()) {
                        streak++;
                    } else {
                        break;
                    }
                }
                return streak;
            }

            getFavoriteSection(progress) {
                const sectionCounts = {};
                Object.keys(progress).forEach(key => {
                    const section = key.split('-')[0];
                    sectionCounts[section] = (sectionCounts[section] || 0) + 1;
                });

                const topSection = Object.keys(sectionCounts).reduce((a, b) =>
                    sectionCounts[a] > sectionCounts[b] ? a : b, '');

                return topSection || 'Nessuna';
            }

            getLastStudyDate(progress) {
                const dates = Object.values(progress).map(p => new Date(p.timestamp));
                return dates.length > 0 ?
                    new Date(Math.max(...dates)).toLocaleDateString() : 'Mai';
            }

            getListeningTime() {
                const listeningTime = localStorage.getItem('studyhub_listening_time') || '0';
                const minutes = Math.floor(parseInt(listeningTime) / 60);
                return `${minutes} minuti`;
            }

            exportNotes() {
                const data = {
                    generatedAt: new Date().toISOString(),
                    bookmarks: this.getBookmarks(),
                    progress: this.getProgress(),
                    preferences: this.getUserPreferences(),
                    stats: this.calculateStats(this.getProgress(), this.getBookmarks()),
                    currentSession: {
                        section: this.currentSection,
                        anchor: this.currentAnchor,
                        readingIndex: this.currentReadingIndex
                    }
                };

                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], {type: 'application/json'});

                const link = document.createElement('a');
                link.href = URL.createObjectURL(dataBlob);
                link.download = `studyhub-export-${new Date().toISOString().split('T')[0]}.json`;
                link.click();

                this.showNotification('📤 Note esportate con successo!', 'success');
            }

            showSearch() {
                const searchTerm = prompt('🔍 Cerca nell\'ebook:\n\nInserisci il termine da cercare:');
                if (searchTerm && searchTerm.trim()) {
                    this.performSearch(searchTerm.trim());
                }
            }

            performSearch(term) {
                const sections = document.querySelectorAll('.section');
                let results = [];

                sections.forEach(section => {
                    const sectionId = section.id;
                    const content = section.innerText.toLowerCase();

                    if (content.includes(term.toLowerCase())) {
                        const title = section.querySelector('.lesson-title')?.textContent || sectionId;
                        results.push({
                            section: sectionId,
                            title: title
                        });
                    }
                });

                if (results.length === 0) {
                    this.showNotification(`❌ Nessun risultato per "${term}"`, 'warning');
                } else {
                    this.showNotification(`🔍 Trovati ${results.length} risultati per "${term}"`, 'success');
                    if (results.length === 1) {
                        this.showSection(results[0].section);
                    }
                }
            }

            toggleMobileMenu() {
                this.showNotification('📱 Menu mobile attivo', 'success');
            }

            updateProgressBar() {
                const currentIndex = this.sections.indexOf(this.currentSection);
                const progress = ((currentIndex + 1) / this.sections.length) * 100;

                const progressBar = document.getElementById('progressBar');
                if (progressBar) {
                    progressBar.style.width = progress + '%';
                }
            }

            saveProgress(sectionId, anchorId = null) {
                const progress = this.getProgress();
                const key = anchorId ? `${sectionId}-${anchorId}` : sectionId;

                progress[key] = {
                    timestamp: new Date().toISOString(),
                    completed: true,
                    readingIndex: this.currentReadingIndex
                };

                localStorage.setItem('studyhub_progress', JSON.stringify(progress));
            }

            getProgress() {
                return JSON.parse(localStorage.getItem('studyhub_progress') || '{}');
            }

            saveUserPreferences() {
                const preferences = {
                    theme: this.isDarkTheme ? 'dark' : 'light',
                    readingSpeed: this.readingSpeed,
                    audioPlayerVisible: this.isAudioPlayerVisible,
                    repeatMode: this.isRepeatMode
                };

                localStorage.setItem('studyhub_preferences', JSON.stringify(preferences));
            }

            loadUserPreferences() {
                const preferences = this.getUserPreferences();

                if (preferences.theme === 'dark') {
                    this.isDarkTheme = true;
                    document.body.classList.add('dark-theme');
                    document.querySelector('#themeBtn i').className = 'fas fa-sun';
                }

                this.readingSpeed = preferences.readingSpeed || 1;
                this.isAudioPlayerVisible = preferences.audioPlayerVisible || false;
                this.isRepeatMode = preferences.repeatMode || false;

                if (this.isAudioPlayerVisible) {
                    this.showAudioPlayer();
                }

                if (this.isRepeatMode) {
                    this.toggleRepeatMode();
                }

                // Update speed button
                document.getElementById('speedBtn').textContent = `${this.readingSpeed}x`;
            }

            getUserPreferences() {
                return JSON.parse(localStorage.getItem('studyhub_preferences') || '{}');
            }

            showNotification(message, type = 'success') {
                const notification = document.getElementById('statusNotification');
                const messageElement = document.getElementById('statusMessage');

                notification.classList.remove('success', 'warning', 'error');
                notification.classList.add(type);

                messageElement.textContent = message;
                notification.classList.add('show');

                setTimeout(() => {
                    notification.classList.remove('show');
                }, 4000);
            }

            showWelcomeNotification() {
                setTimeout(() => {
                    this.showNotification('🚀 StudyHub migliorato! Usa Ctrl+Space per la lettura audio intelligente', 'success');
                }, 1000);
            }

            // Public methods for global access
            goToSection(sectionId, anchorId = null) {
                this.showSection(sectionId, anchorId);
            }

            getCurrentSection() {
                return this.currentSection;
            }

            getStudyData() {
                return {
                    progress: this.getProgress(),
                    bookmarks: this.getBookmarks(),
                    preferences: this.getUserPreferences(),
                    currentSession: {
                        section: this.currentSection,
                        anchor: this.currentAnchor,
                        readingIndex: this.currentReadingIndex
                    }
                };}
        }

        // Initialize the enhanced ebook when DOM is ready
        document.addEventListener('DOMContentLoaded', () => {
            window.studyHub = new EnhancedStudyHubManager();

            // Request notification permission
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }

            // Handle visibility change for better performance
            document.addEventListener('visibilitychange', () => {
                if (document.hidden && window.studyHub.isReading) {
                    window.studyHub.pauseReading();
                }
            });

            // Handle beforeunload for cleanup
            window.addEventListener('beforeunload', () => {
                if (window.studyHub.pomodoroTimer) {
                    clearInterval(window.studyHub.pomodoroTimer);
                }
                if (window.studyHub.speechSynthesis) {
                    window.studyHub.speechSynthesis.cancel();
                }

                // Save listening time
                const currentTime = parseInt(localStorage.getItem('studyhub_listening_time') || '0');
                localStorage.setItem('studyhub_listening_time', (currentTime + 60).toString());
            });

            // Add resize handler for responsive behavior
            window.addEventListener('resize', () => {
                // Adjust audio player for mobile
                const audioPlayer = document.getElementById('audioPlayer');
                if (window.innerWidth <= 768 && audioPlayer.classList.contains('visible')) {
                    audioPlayer.style.width = 'calc(100vw - 2rem)';
                    audioPlayer.style.minWidth = 'auto';
                } else if (audioPlayer.classList.contains('visible')) {
                    audioPlayer.style.width = '';
                    audioPlayer.style.minWidth = '320px';
                }
            });

            // Handle speech synthesis voices loading
            window.speechSynthesis.onvoiceschanged = () => {
                const voices = window.speechSynthesis.getVoices();
                const italianVoices = voices.filter(voice => voice.lang.startsWith('it'));

                if (italianVoices.length > 0) {
                    console.log('🎤 Voci italiane disponibili:', italianVoices.map(v => v.name));
                } else {
                    console.warn('⚠️ Nessuna voce italiana trovata');
                }
            };

            // Add service worker for offline support (if needed)
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.register('/sw.js').then(registration => {
                    console.log('📱 Service Worker registrato:', registration);
                }).catch(error => {
                    console.log('❌ Service Worker fallito:', error);
                });
            }

            console.log(`
🎉 STUDYHUB ENHANCED CARICATO CON SUCCESSO!

✨ Nuove funzionalità:
🎧 Lettura audio intelligente con navigazione
⏮️⏭️ Pulsanti precedente/successivo per gli elementi
🔄 Modalità ripetizione per riascoltare
📍 Lettura dal punto selezionato nell'indice
📱 Design responsive migliorato per mobile
🎯 Evidenziazione elemento corrente
🔊 Controlli audio avanzati
⌨️ Scorciatoie tastiera potenziate
👆 Gesture touch migliorati
🍅 Timer Pomodoro integrato
📊 Statistiche di studio avanzate

🎮 Comandi principali:
• Ctrl + Space: Avvia/Pausa lettura
• Frecce ← →: Naviga elementi (durante lettura)
• Escape: Ferma tutto
• Ctrl + B: Aggiungi bookmark
• Ctrl + T: Cambia tema

🚀 Buono studio con il nuovo StudyHub!
            `);
        });

        // Global functions for backwards compatibility and console access
        function showSection(sectionId, anchorId = null) {
            if (window.studyHub) {
                window.studyHub.goToSection(sectionId, anchorId);
            }
        }

        function toggleTheme() {
            if (window.studyHub) {
                window.studyHub.toggleTheme();
            }
        }

        function startReading() {
            if (window.studyHub) {
                window.studyHub.startReading();
            }
        }

        function stopReading() {
            if (window.studyHub) {
                window.studyHub.stopReading();
            }
        }

        function nextElement() {
            if (window.studyHub) {
                window.studyHub.nextElement();
            }
        }

        function previousElement() {
            if (window.studyHub) {
                window.studyHub.previousElement();
            }
        }

        function showStats() {
            if (window.studyHub) {
                window.studyHub.showStats();
            }
        }

        function addBookmark() {
            if (window.studyHub) {
                window.studyHub.addBookmark();
            }
        }

        function exportNotes() {
            if (window.studyHub) {
                window.studyHub.exportNotes();
            }
        }

        function startPomodoro() {
            if (window.studyHub) {
                window.studyHub.startPomodoro();
            }
        }

        function toggleAudioPlayer() {
            if (window.studyHub) {
                window.studyHub.toggleAudioPlayer();
            }
        }

        // Enhanced error handling
        window.addEventListener('error', (event) => {
            console.error('❌ Errore JavaScript:', event.error);

            if (window.studyHub) {
                window.studyHub.showNotification('❌ Si è verificato un errore', 'error');
            }
        });

        // Enhanced unhandled promise rejection handling
        window.addEventListener('unhandledrejection', (event) => {
            console.error('❌ Promise rejections:', event.reason);

            if (window.studyHub) {
                window.studyHub.showNotification('⚠️ Errore di connessione', 'warning');
            }
        });

        // Additional CSS for enhanced mobile experience
        const mobileEnhancedCSS = `
        /* Enhanced mobile touch targets */
        @media (max-width: 768px) {
            .current-reading {
                background: var(--accent-color) !important;
                color: white !important;
                padding: 0.75rem !important;
                border-radius: var(--border-radius-lg) !important;
                margin: 0.5rem 0 !important;
                box-shadow: var(--shadow-lg) !important;
                animation: mobileHighlight 1s ease-in-out !important;
            }

            @keyframes mobileHighlight {
                0%, 100% { transform: scale(1); }
                50% { transform: scale(1.02); }
            }

            .toc-item.current-reading {
                background: var(--accent-color) !important;
                color: white !important;
                font-weight: bold !important;
                transform: translateX(8px) !important;
                border-left-color: var(--warning-color) !important;
            }

            .audio-player.visible {
                animation: slideUpMobile 0.4s ease-out !important;
            }

            @keyframes slideUpMobile {
                from {
                    transform: translateY(100%);
                    opacity: 0;
                }
                to {
                    transform: translateY(0);
                    opacity: 1;
                }
            }

            .nav-btn, .control-btn {
                min-width: 44px !important;
                min-height: 44px !important;
                font-size: 1.1rem !important;
            }

            .play-btn {
                min-width: 54px !important;
                min-height: 54px !important;
                font-size: 1.3rem !important;
            }

            .status-notification {
                font-size: 0.95rem !important;
                padding: 1rem 1.25rem !important;
                border-radius: var(--border-radius-lg) !important;
            }

            .audio-controls {
                padding: 0.5rem !important;
                background: var(--bg-secondary) !important;
                border-radius: var(--border-radius-lg) !important;
                margin-bottom: 1rem !important;
            }

            .main-audio-controls {
                justify-content: space-around !important;
                flex: 1 !important;
            }

            .current-reading-info {
                font-size: 0.85rem !important;
                line-height: 1.4 !important;
                padding: 1rem !important;
            }

            /* Better touch feedback */
            .subject-btn:active,
            .action-btn:active,
            .nav-btn:active,
            .control-btn:active,
            .play-btn:active {
                transform: scale(0.95) !important;
                transition: transform 0.1s ease !important;
            }

            /* Improved text readability on mobile */
            .card {
                font-size: 0.95rem !important;
                line-height: 1.6 !important;
            }

            .card-title {
                font-size: 1.1rem !important;
                margin-bottom: 0.75rem !important;
            }

            .lesson-content h2 {
                font-size: 1.6rem !important;
                margin-bottom: 1rem !important;
                line-height: 1.3 !important;
            }

            .lesson-content h3 {
                font-size: 1.3rem !important;
                margin-bottom: 0.75rem !important;
                margin-top: 1.5rem !important;
            }

            .lesson-content p {
                margin-bottom: 1rem !important;
                line-height: 1.7 !important;
            }

            .lesson-content ul, .lesson-content ol {
                margin-bottom: 1rem !important;
                padding-left: 1.5rem !important;
            }

            .lesson-content li {
                margin-bottom: 0.5rem !important;
                line-height: 1.6 !important;
            }
        }

        /* Enhanced dark theme for mobile */
        @media (max-width: 768px) {
            .dark-theme .current-reading {
                background: var(--warning-color) !important;
                color: var(--bg-primary) !important;
                box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3) !important;
            }

            .dark-theme .audio-player {
                background: rgba(51, 65, 85, 0.95) !important;
                backdrop-filter: blur(20px) !important;
                border: 1px solid var(--border-color) !important;
            }

            .dark-theme .status-notification {
                background: var(--bg-card) !important;
                border: 1px solid var(--border-color) !important;
            }
        }

        /* Accessibility improvements for mobile */
        @media (max-width: 768px) {
            .sr-only {
                position: absolute !important;
                width: 1px !important;
                height: 1px !important;
                padding: 0 !important;
                margin: -1px !important;
                overflow: hidden !important;
                clip: rect(0, 0, 0, 0) !important;
                white-space: nowrap !important;
                border: 0 !important;
            }

            .nav-btn:focus,
            .control-btn:focus,
            .play-btn:focus {
                outline: 3px solid var(--primary-color) !important;
                outline-offset: 2px !important;
            }

            .toc-item:focus,
            .lesson-link:focus {
                outline: 2px solid var(--primary-color) !important;
                outline-offset: 1px !important;
                background: var(--primary-light) !important;
                color: white !important;
            }
        }

        /* Loading states for better UX */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--bg-secondary);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .play-btn.loading::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border: 2px solid rgba(255,255,255,0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
        }

        /* Error states */
        .error-state {
            background: var(--error-color) !important;
            color: white !important;
            animation: shake 0.5s ease-in-out !important;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        /* Success states */
        .success-state {
            background: var(--success-color) !important;
            color: white !important;
            animation: bounce 0.6s ease-in-out !important;
        }

        @keyframes bounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        `;

        // Append mobile enhanced CSS
        const mobileStyleSheet = document.createElement('style');
        mobileStyleSheet.textContent = mobileEnhancedCSS;
        document.head.appendChild(mobileStyleSheet);

        // Add meta tag for better mobile experience
        const viewportMeta = document.querySelector('meta[name="viewport"]');
        if (viewportMeta) {
            viewportMeta.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes');
        }

        // Add theme-color meta for mobile browsers
        const themeColorMeta = document.createElement('meta');
        themeColorMeta.name = 'theme-color';
        themeColorMeta.content = '#6366f1';
        document.head.appendChild(themeColorMeta);

        // Add apple-mobile-web-app-capable for iOS
        const appleMobileMeta = document.createElement('meta');
        appleMobileMeta.name = 'apple-mobile-web-app-capable';
        appleMobileMeta.content = 'yes';
        document.head.appendChild(appleMobileMeta);
    </script>
</body>
</html>
